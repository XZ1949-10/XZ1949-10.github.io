<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>seq2seq与Attention机制 | 深度学习</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.6.7">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../gitbook/style.css">
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-katex/katex.min.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-highlight/website.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-search/search.css">
        
    
        
        <link rel="stylesheet" href="../gitbook/plugins/gitbook-plugin-fontsettings/website.css">
        
    
    

        
    
    
    <link rel="next" href="../day04/section4.html" />
    
    
    <link rel="prev" href="../day04/section2.html" />
    

        
    </head>
    <body>
        
        
    <div class="book"
        data-level="4.3"
        data-chapter-title="seq2seq与Attention机制"
        data-filepath="day04/section3.md"
        data-basepath=".."
        data-revision="Mon Nov 19 2018 17:05:39 GMT+0800 (CST)"
        data-innerlanguage="">
    

<div class="book-summary">
    <nav role="navigation">
        <ul class="summary">
            
            
            
            

            

            
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        深度学习
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="day01/index.html">
            
                
                    <a href="../day01/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        深度学习与神经网络
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="day01/section1.html">
            
                
                    <a href="../day01/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        深度学习介绍
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="day01/section2.html">
            
                
                    <a href="../day01/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.2.</b>
                        
                        神经网络基础
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="day01/section3.html">
            
                
                    <a href="../day01/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        浅层神经网络
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="day01/section4.html">
            
                
                    <a href="../day01/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.4.</b>
                        
                        深层神经网络
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="day01/section5.html">
            
                
                    <a href="../day01/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.5.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="day01/section6.html">
            
                
                    <a href="../day01/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.6.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="day02/index.html">
            
                
                    <a href="../day02/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        深度学习进阶
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="day02/section1.html">
            
                
                    <a href="../day02/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        多分类与TensorFlow
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="day02/section2.html">
            
                
                    <a href="../day02/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        梯度下降算法改进
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="day02/section3.html">
            
                
                    <a href="../day02/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        深度学习正则化
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="day02/section4.html">
            
                
                    <a href="../day02/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        神经网络调优与BN
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="day02/section5.html">
            
                
                    <a href="../day02/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="day02/section6.html">
            
                
                    <a href="../day02/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="day03/index.html">
            
                
                    <a href="../day03/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        卷积神经网络
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="day03/section1.html">
            
                
                    <a href="../day03/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        图像数据与边缘检测
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="day03/section2.html">
            
                
                    <a href="../day03/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        卷积神经网络(CNN)原理
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="day03/section3.html">
            
                
                    <a href="../day03/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        经典分类网络结构
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="day03/section4.html">
            
                
                    <a href="../day03/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        CNN网络实战技巧
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="day03/section5.html">
            
                
                    <a href="../day03/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="day03/section6.html">
            
                
                    <a href="../day03/section6.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" data-path="day04/index.html">
            
                
                    <a href="../day04/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        循环神经网络
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1" data-path="day04/section1.html">
            
                
                    <a href="../day04/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.1.</b>
                        
                        循环神经网络
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.2" data-path="day04/section2.html">
            
                
                    <a href="../day04/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.2.</b>
                        
                        词嵌入与NLP
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="4.3" data-path="day04/section3.html">
            
                
                    <a href="../day04/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.3.</b>
                        
                        seq2seq与Attention机制
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.4" data-path="day04/section4.html">
            
                
                    <a href="../day04/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.4.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="4.5" data-path="day04/section5.html">
            
                
                    <a href="../day04/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.5.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5" data-path="day05/index.html">
            
                
                    <a href="../day05/index.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        高级主题
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="day05/section1.html">
            
                
                    <a href="../day05/section1.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        生成对抗网络(GAN)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="day05/section2.html">
            
                
                    <a href="../day05/section2.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        自动编码器
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="day05/section3.html">
            
                
                    <a href="../day05/section3.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        CapsuleNet
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="day05/section4.html">
            
                
                    <a href="../day05/section4.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        总结
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="day05/section5.html">
            
                
                    <a href="../day05/section5.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        每日作业
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    


            
            <li class="divider"></li>
            <li>
                <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                    Published with GitBook
                </a>
            </li>
            
        </ul>
    </nav>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header" role="navigation">
    <!-- Actions Left -->
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../" > 深度学习</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1" role="main">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="43-seq2seq&#x4E0E;attention&#x673A;&#x5236;">4.3 seq2seq&#x4E0E;Attention&#x673A;&#x5236;</h1>
<h2 id="&#x5B66;&#x4E60;&#x76EE;&#x6807;">&#x5B66;&#x4E60;&#x76EE;&#x6807;</h2>
<ul>
<li>&#x76EE;&#x6807;<ul>
<li>&#x638C;&#x63E1;seq2seq&#x6A21;&#x578B;&#x7279;&#x70B9;</li>
<li>&#x638C;&#x63E1;&#x96C6;&#x675F;&#x641C;&#x7D22;&#x65B9;&#x5F0F;</li>
<li>&#x638C;&#x63E1;BLEU&#x8BC4;&#x4F30;&#x65B9;&#x6CD5;</li>
<li>&#x638C;&#x63E1;Attention&#x673A;&#x5236;</li>
</ul>
</li>
<li>&#x5E94;&#x7528;<ul>
<li>&#x5E94;&#x7528;Keras&#x5B9E;&#x73B0;seq2seq&#x5BF9;&#x65E5;&#x671F;&#x683C;&#x5F0F;&#x7684;&#x7FFB;&#x8BD1;</li>
</ul>
</li>
</ul>
<h3 id="431-seq2seq">4.3.1 seq2seq</h3>
<p>seq2seq&#x6A21;&#x578B;&#x662F;&#x5728;2014&#x5E74;&#xFF0C;&#x662F;&#x7531;Google Brain&#x56E2;&#x961F;&#x548C;Yoshua Bengio &#x4E24;&#x4E2A;&#x56E2;&#x961F;&#x5404;&#x81EA;&#x72EC;&#x7ACB;&#x7684;&#x63D0;&#x51FA;&#x6765;&#x3002;</p>
<h4 id="4311-&#x5B9A;&#x4E49;">4.3.1.1 &#x5B9A;&#x4E49;</h4>
<p>seq2seq&#x662F;&#x4E00;&#x4E2A;<strong>Encoder&#x2013;Decoder &#x7ED3;&#x6784;</strong>&#x7684;&#x7F51;&#x7EDC;&#xFF0C;&#x5B83;&#x7684;&#x8F93;&#x5165;&#x662F;&#x4E00;&#x4E2A;&#x5E8F;&#x5217;&#xFF0C;&#x8F93;&#x51FA;&#x4E5F;&#x662F;&#x4E00;&#x4E2A;&#x5E8F;&#x5217;&#xFF0C; <strong>Encoder &#x4E2D;&#x5C06;&#x4E00;&#x4E2A;&#x53EF;&#x53D8;&#x957F;&#x5EA6;&#x7684;&#x4FE1;&#x53F7;&#x5E8F;&#x5217;&#x53D8;&#x4E3A;&#x56FA;&#x5B9A;&#x957F;&#x5EA6;&#x7684;&#x5411;&#x91CF;&#x8868;&#x8FBE;</strong>&#xFF0C;<strong>Decoder &#x5C06;&#x8FD9;&#x4E2A;&#x56FA;&#x5B9A;&#x957F;&#x5EA6;&#x7684;&#x5411;&#x91CF;&#x53D8;&#x6210;&#x53EF;&#x53D8;&#x957F;&#x5EA6;&#x7684;&#x76EE;&#x6807;&#x7684;&#x4FE1;&#x53F7;&#x5E8F;&#x5217;&#x3002;</strong></p>
<p><img src="../images/seq2seq.png" alt=""></p>
<p>&#x6CE8;&#xFF1A;Cell&#x53EF;&#x4EE5;&#x7528; RNN &#xFF0C;GRU&#xFF0C;LSTM &#x7B49;&#x7ED3;&#x6784;&#x3002;</p>
<ul>
<li>&#x76F8;&#x5F53;&#x4E8E;&#x5C06;RNN&#x6A21;&#x578B;&#x5F53;&#x4E2D;&#x7684;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>s</mi><mrow><mn>0</mn></mrow></msup></mrow><annotation encoding="application/x-tex">s^{0}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:0.8141079999999999em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">s</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">0</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x8F93;&#x5165;&#x53D8;&#x6210;&#x4E00;&#x4E2A;encoder</li>
</ul>
<h4 id="4312-&#x6761;&#x4EF6;&#x8BED;&#x8A00;&#x6A21;&#x578B;&#x7406;&#x89E3;">4.3.1.2 &#x6761;&#x4EF6;&#x8BED;&#x8A00;&#x6A21;&#x578B;&#x7406;&#x89E3;</h4>
<ul>
<li>1&#x3001;&#x7F16;&#x89E3;&#x7801;&#x5668;&#x4F5C;&#x7528;<ul>
<li>&#x7F16;&#x7801;&#x5668;&#x7684;&#x4F5C;&#x7528;&#x662F;&#x628A;&#x4E00;&#x4E2A;&#x4E0D;&#x5B9A;&#x957F;&#x7684;&#x8F93;&#x5165;&#x5E8F;&#x5217;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mrow><mn>1</mn></mrow></msub><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><msub><mi>x</mi><mrow><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">x_{1},\ldots,x_{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>,&#x8F93;&#x51FA;&#x5230;&#x4E00;&#x4E2A;&#x7F16;&#x7801;&#x72B6;&#x6001;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span></li>
<li>&#x89E3;&#x7801;&#x5668;&#x8F93;&#x51FA;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mrow><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">y^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.7935559999999999em;"></span><span class="strut bottom" style="height:0.9879959999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x7684;&#x6761;&#x4EF6;&#x6982;&#x7387;&#x5C06;&#x57FA;&#x4E8E;&#x4E4B;&#x524D;&#x7684;&#x8F93;&#x51FA;&#x5E8F;&#x5217;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mrow><mn>1</mn></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mi>t</mi><mo>&#x2212;</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">y^{1}, y^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">t</span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x548C;&#x7F16;&#x7801;&#x72B6;&#x6001;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span></li>
</ul>
</li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>a</mi><mi>r</mi><mi>g</mi><mi>m</mi><mi>a</mi><mi>x</mi><mrow><mi>P</mi></mrow><mo>(</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><msub><mi>y</mi><mrow><msup><mi>T</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msub><mo>&#x2223;</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>T</mi></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">argmax {P}(y_1, \ldots, y_{T&apos;} \mid x_1, \ldots, x_T)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.75em;"></span><span class="strut bottom" style="height:1em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit">a</span><span class="mord mathit" style="margin-right:0.02778em;">r</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2223;</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span>&#xFF0C;&#x7ED9;&#x5B9A;&#x8F93;&#x5165;&#x7684;&#x5E8F;&#x5217;&#xFF0C;&#x4F7F;&#x5F97;&#x8F93;&#x51FA;&#x5E8F;&#x5217;&#x7684;&#x6982;&#x7387;&#x503C;&#x6700;&#x5927;&#x3002;</p>
<ul>
<li>2&#x3001;&#x6839;&#x636E;&#x6700;&#x5927;&#x4F3C;&#x7136;&#x4F30;&#x8BA1;&#xFF0C;&#x6700;&#x5927;&#x5316;&#x8F93;&#x51FA;&#x5E8F;&#x5217;&#x7684;&#x6982;&#x7387;</li>
</ul>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mrow><mi>P</mi></mrow><mo>(</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><msub><mi>y</mi><mrow><msup><mi>T</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msub><mo>&#x2223;</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>T</mi></msub><mo>)</mo><mo>=</mo><msubsup><mo>&#x220F;</mo><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>=</mo><mn>1</mn></mrow><mrow><msup><mi>T</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msubsup><mrow><mi>P</mi></mrow><mo>(</mo><msub><mi>y</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msub><mo>&#x2223;</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><msub><mi>y</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>T</mi></msub><mo>)</mo><mo>=</mo><msubsup><mo>&#x220F;</mo><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>=</mo><mn>1</mn></mrow><mrow><msup><mi>T</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msubsup><mrow><mi>P</mi></mrow><mo>(</mo><msub><mi>y</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msub><mo>&#x2223;</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><msub><mi>y</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mrow><mi>C</mi></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">{P}(y_1, \ldots, y_{T&apos;} \mid x_1, \ldots, x_T) = \prod_{t&apos;=1}^{T&apos;} {P}(y_{t&apos;} \mid y_1, \ldots, y_{t&apos;-1}, x_1, \ldots, x_T) = \prod_{t&apos;=1}^{T&apos;} {P}(y_{t&apos;} \mid y_1, \ldots, y_{t&apos;-1}, {C})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.94348em;"></span><span class="strut bottom" style="height:1.24349em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2223;</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x220F;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist"><span style="top:-0.431em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped mtight"><span class="mord scriptscriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2223;</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x220F;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist"><span style="top:-0.431em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped mtight"><span class="mord scriptscriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2223;</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span><span class="mclose">)</span></span></span></span></p>
<p>&#x7531;&#x4E8E;&#x8FD9;&#x4E2A;&#x516C;&#x5F0F;&#x9700;&#x8981;&#x6C42;&#x51FA;&#xFF1A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msup><mi>y</mi><mrow><mn>1</mn></mrow></msup><mi mathvariant="normal">&#x2223;</mi><mi>C</mi><mo>)</mo><mo>&#x2217;</mo><mi>P</mi><mo>(</mo><msup><mi>y</mi><mrow><mn>2</mn></mrow></msup><mi mathvariant="normal">&#x2223;</mi><msup><mi>y</mi><mrow><mn>1</mn></mrow></msup><mo separator="true">,</mo><mi>C</mi><mo>)</mo><mo>&#x2217;</mo><mi>P</mi><mo>(</mo><msup><mi>y</mi><mrow><mn>3</mn></mrow></msup><mi mathvariant="normal">&#x2223;</mi><msup><mi>y</mi><mrow><mn>2</mn></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mn>2</mn></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mn>1</mn></mrow></msup><mo separator="true">,</mo><mi>C</mi><mo>)</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">P(y^{1}|C) * P(y^{2}|y^{1},C)*P(y^{3}|y^{2},y^{2},y^{1},C)...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mbin">&#x2217;</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mbin">&#x2217;</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span></span></span></span>&#x8FD9;&#x4E2A;&#x6982;&#x7387;&#x8FDE;&#x4E58;&#x4F1A;&#x975E;&#x5E38;&#x975E;&#x5E38;&#x5C0F;&#x4E0D;&#x5229;&#x4E8E;&#x8BA1;&#x7B97;&#x5B58;&#x50A8;&#xFF0C;&#x6240;&#x4EE5;&#x9700;&#x8981;&#x5BF9;&#x516C;&#x5F0F;&#x53D6;&#x5BF9;&#x6570;&#x8BA1;&#x7B97;&#xFF1A;</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>log</mi><mrow><mi>P</mi></mrow><mo>(</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><msub><mi>y</mi><mrow><msup><mi>T</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msub><mo>&#x2223;</mo><msub><mi>x</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><msub><mi>x</mi><mi>T</mi></msub><mo>)</mo><mo>=</mo><msubsup><mo>&#x2211;</mo><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>=</mo><mn>1</mn></mrow><mrow><msup><mi>T</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msubsup><mi>log</mi><mrow><mi>P</mi></mrow><mo>(</mo><msub><mi>y</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msub><mo>&#x2223;</mo><msub><mi>y</mi><mn>1</mn></msub><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><msub><mi>y</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mrow><mi>C</mi></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">\log{P}(y_1, \ldots, y_{T&apos;} \mid x_1, \ldots, x_T) = \sum_{t&apos;=1}^{T&apos;} \log{P}(y_{t&apos;} \mid y_1, \ldots, y_{t&apos;-1}, {C})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.94348em;"></span><span class="strut bottom" style="height:1.24349em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2223;</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit">x</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist"><span style="top:-0.431em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped mtight"><span class="mord scriptscriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">&#x2223;</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.03588em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span><span class="mclose">)</span></span></span></span></p>
<p>&#x6240;&#x4EE5;&#x8FD9;&#x6837;&#x5C31;&#x53D8;&#x6210;&#x4E86;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>P</mi><mo>(</mo><msup><mi>y</mi><mrow><mn>1</mn></mrow></msup><mi mathvariant="normal">&#x2223;</mi><mi>C</mi><mo>)</mo><mo>+</mo><mi>P</mi><mo>(</mo><msup><mi>y</mi><mrow><mn>2</mn></mrow></msup><mi mathvariant="normal">&#x2223;</mi><msup><mi>y</mi><mrow><mn>1</mn></mrow></msup><mo separator="true">,</mo><mi>C</mi><mo>)</mo><mo>+</mo><mi>P</mi><mo>(</mo><msup><mi>y</mi><mrow><mn>3</mn></mrow></msup><mi mathvariant="normal">&#x2223;</mi><msup><mi>y</mi><mrow><mn>2</mn></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mn>2</mn></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mn>1</mn></mrow></msup><mo separator="true">,</mo><mi>C</mi><mo>)</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow><annotation encoding="application/x-tex">P(y^{1}|C)+ P(y^{2}|y^{1},C)+P(y^{3}|y^{2},y^{2},y^{1},C)...</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.064108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm">&#x2223;</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mclose">)</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span></span></span></span>&#x6982;&#x7387;&#x76F8;&#x52A0;&#x3002;<strong>&#x8FD9;&#x6837;&#x4E5F;&#x53EF;&#x4EE5;&#x770B;&#x6210;&#x8F93;&#x51FA;&#x7ED3;&#x679C;&#x901A;&#x8FC7;softmax&#x5C31;&#x53D8;&#x6210;&#x4E86;&#x6982;&#x7387;&#x6700;&#x5927;&#xFF0C;&#x800C;&#x635F;&#x5931;&#x6700;&#x5C0F;&#x7684;&#x95EE;&#x9898;&#xFF0C;&#x8F93;&#x51FA;&#x5E8F;&#x5217;&#x635F;&#x5931;&#x6700;&#x5C0F;&#x5316;&#x3002;</strong></p>
<h4 id="4313-&#x5E94;&#x7528;&#x573A;&#x666F;">4.3.1.3 &#x5E94;&#x7528;&#x573A;&#x666F;</h4>
<ul>
<li>&#x795E;&#x7ECF;&#x673A;&#x5668;&#x7FFB;&#x8BD1;(NMT)</li>
</ul>
<p><img src="../images/seq2seq&#x8FC7;&#x7A0B;.png" alt=""></p>
<ul>
<li>&#x804A;&#x5929;&#x673A;&#x5668;&#x4EBA;</li>
</ul>
<p>&#x63A5;&#x4E0B;&#x6765;&#x6211;&#x4EEC;&#x6765;&#x770B;&#x6CE8;&#x610F;&#x529B;&#x673A;&#x5236;&#xFF0C;&#x90A3;&#x4E48;&#x666E;&#x901A;&#x7684;seq2seq&#x4F1A;&#x9762;&#x4E34;&#x4EC0;&#x4E48;&#x6837;&#x7684;&#x95EE;&#x9898;&#xFF1F;</p>
<h3 id="432-&#x6CE8;&#x610F;&#x529B;&#x673A;&#x5236;">4.3.2 &#x6CE8;&#x610F;&#x529B;&#x673A;&#x5236;</h3>
<h4 id="4321-&#x957F;&#x53E5;&#x5B50;&#x95EE;&#x9898;">4.3.2.1 &#x957F;&#x53E5;&#x5B50;&#x95EE;&#x9898;</h4>
<p><img src="../images/&#x957F;&#x53E5;&#x5B50;&#x7FFB;&#x8BD1;.png" alt=""></p>
<p>&#x5BF9;&#x4E8E;&#x66F4;&#x957F;&#x7684;&#x53E5;&#x5B50;&#xFF0C;seq2seq&#x5C31;&#x663E;&#x5F97;&#x529B;&#x4E0D;&#x4ECE;&#x5FC3;&#x4E86;&#xFF0C;&#x65E0;&#x6CD5;&#x505A;&#x5230;&#x51C6;&#x786E;&#x7684;&#x7FFB;&#x8BD1;&#xFF0C;&#x4E00;&#x4E0B;&#x662F;&#x901A;&#x5E38;BLEU&#x7684;&#x5206;&#x6570;&#x968F;&#x7740;&#x53E5;&#x5B50;&#x7684;&#x957F;&#x5EA6;&#x53D8;&#x5316;&#xFF0C;&#x53EF;&#x4EE5;&#x770B;&#x5230;&#x53E5;&#x5B50;&#x975E;&#x5E38;&#x957F;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x5206;&#x6570;&#x5C31;&#x5F88;&#x4F4E;&#x3002;</p>
<p><img src="../images/BLEU&#x53E5;&#x5B50;&#x957F;&#x5EA6;&#x53D8;&#x5316;.png" alt=""></p>
<p>&#x672C;&#x8D28;&#x539F;&#x56E0;&#xFF1A;&#x5728;Encoder-Decoder&#x7ED3;&#x6784;&#x4E2D;&#xFF0C;Encoder&#x628A;&#x6240;&#x6709;&#x7684;&#x8F93;&#x5165;&#x5E8F;&#x5217;&#x90FD;&#x7F16;&#x7801;&#x6210;&#x4E00;&#x4E2A;&#x7EDF;&#x4E00;&#x7684;&#x8BED;&#x4E49;&#x7279;&#x5F81;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span>&#x518D;&#x89E3;&#x7801;&#xFF0C;<strong>&#x56E0;&#x6B64;&#xFF0C; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span>&#x4E2D;&#x5FC5;&#x987B;&#x5305;&#x542B;&#x539F;&#x59CB;&#x5E8F;&#x5217;&#x4E2D;&#x7684;&#x6240;&#x6709;&#x4FE1;&#x606F;&#xFF0C;&#x5B83;&#x7684;&#x957F;&#x5EA6;&#x5C31;&#x6210;&#x4E86;&#x9650;&#x5236;&#x6A21;&#x578B;&#x6027;&#x80FD;&#x7684;&#x74F6;&#x9888;&#x3002;</strong>&#x5F53;&#x8981;&#x7FFB;&#x8BD1;&#x7684;&#x53E5;&#x5B50;&#x8F83;&#x957F;&#x65F6;&#xFF0C;&#x4E00;&#x4E2A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex">C</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.68333em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span></span></span></span>&#x53EF;&#x80FD;&#x5B58;&#x4E0D;&#x4E0B;&#x90A3;&#x4E48;&#x591A;&#x4FE1;&#x606F;&#xFF0C;&#x5C31;&#x4F1A;&#x9020;&#x6210;&#x7FFB;&#x8BD1;&#x7CBE;&#x5EA6;&#x7684;&#x4E0B;&#x964D;&#x3002;</p>
<h4 id="4322-&#x5B9A;&#x4E49;">4.3.2.2 &#x5B9A;&#x4E49;</h4>
<ul>
<li>&#x5EFA;&#x7ACB;Encoder&#x7684;&#x9690;&#x5C42;&#x72B6;&#x6001;&#x8F93;&#x51FA;&#x5230;Decoder&#x5BF9;&#x5E94;&#x8F93;&#x51FA;y<strong>&#x6240;&#x9700;&#x8981;&#x7684;&#x4E0A;&#x4E0B;&#x6587;&#x4FE1;&#x606F;</strong><ul>
<li>&#x76EE;&#x7684;&#xFF1A;&#x589E;&#x52A0;&#x7F16;&#x7801;&#x5668;&#x4FE1;&#x606F;&#x8F93;&#x5165;&#x5230;&#x89E3;&#x7801;&#x5668;&#x4E2D;&#x76F8;&#x540C;&#x65F6;&#x523B;&#x7684;&#x8054;&#x7CFB;&#xFF0C;&#x5176;&#x5B83;&#x65F6;&#x523B;&#x4FE1;&#x606F;&#x51CF;&#x5F31;</li>
</ul>
</li>
</ul>
<p><img src="../images/Attention&#x673A;&#x5236;.png" alt=""></p>
<h4 id="4323-&#x516C;&#x5F0F;">4.3.2.3 &#x516C;&#x5F0F;</h4>
<p>&#x6CE8;&#x610F;&#x4E0A;&#x8FF0;&#x7684;&#x51E0;&#x4E2A;&#x7EC6;&#x8282;&#xFF0C;&#x989C;&#x8272;&#x7684;&#x8FDE;&#x63A5;&#x6DF1;&#x6D45;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x5047;&#x8BBE;Encoder&#x7684;&#x65F6;&#x523B;&#x8BB0;&#x4E3A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.61508em;"></span><span class="strut bottom" style="height:0.61508em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">t</span></span></span></span>,&#x800C;Decoder&#x7684;&#x65F6;&#x523B;&#x8BB0;&#x4E3A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>t</mi><mrow><msup><mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msup></mrow><annotation encoding="application/x-tex">t^{&apos;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.94248em;"></span><span class="strut bottom" style="height:0.94248em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist"><span style="top:-0.431em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped mtight"><span class="mord scriptscriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x3002;</p>
<ul>
<li><p>1&#x3001;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mrow><mi>c</mi></mrow><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msub><mo>=</mo><msubsup><mo>&#x2211;</mo><mrow><mi>t</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><msub><mi>&#x3B1;</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>t</mi></mrow></msub><msub><mrow><mi>h</mi></mrow><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">{c}_{t&apos;} = \sum_{t=1}^T \alpha_{t&apos; t}{h}_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8423309999999999em;"></span><span class="strut bottom" style="height:1.142341em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit">c</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">t</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B1;</mi><mrow><msup><mi>t</mi><mrow><msup><mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msup><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{t^{&apos;}t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.7107399999999999em;vertical-align:-0.28018em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="msupsub"><span class="vlist"><span style="top:0.28018em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist"><span style="top:-0.294em;margin-right:0.1em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x4E3A;&#x53C2;&#x6570;&#xFF0C;&#x5728;&#x7F51;&#x7EDC;&#x4E2D;&#x8BAD;&#x7EC3;&#x5F97;&#x5230;</li>
<li>&#x7406;&#x89E3;&#xFF1A;&#x84DD;&#x8272;&#x7684;&#x89E3;&#x7801;&#x5668;&#x4E2D;&#x7684;cell&#x4E3E;&#x4F8B;&#x5B50;</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B1;</mi><mrow><mn>4</mn></mrow></msub><mrow><mn>1</mn></mrow><msub><mi>h</mi><mrow><mn>1</mn></mrow></msub><mo>+</mo><msub><mi>&#x3B1;</mi><mrow><mn>4</mn></mrow></msub><mrow><mn>2</mn></mrow><msub><mi>h</mi><mrow><mn>2</mn></mrow></msub><mo>+</mo><msub><mi>&#x3B1;</mi><mrow><mn>4</mn></mrow></msub><mrow><mn>3</mn></mrow><msub><mi>h</mi><mrow><mn>3</mn></mrow></msub><mo>+</mo><msub><mi>&#x3B1;</mi><mrow><mn>4</mn></mrow></msub><mrow><mn>4</mn></mrow><msub><mi>h</mi><mrow><mn>4</mn></mrow></msub><mo>=</mo><msub><mi>c</mi><mrow><mn>4</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{4}{1}h_{1}+\alpha_{4}{2}h_{2} + \alpha_{4}{3}h_{3} + \alpha_{4}{4}h_{4} = c_{4}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord mathrm">1</span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord mathrm">2</span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord mathrm">3</span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord mathrm">4</span></span><span class="mord"><span class="mord mathit">h</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord"><span class="mord mathit">c</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></li>
</ul>
</li>
<li><p>2&#x3001;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B1;</mi><mrow><msup><mi>t</mi><mrow><msup><mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msup><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\alpha_{t^{&apos;}t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.7107399999999999em;vertical-align:-0.28018em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="msupsub"><span class="vlist"><span style="top:0.28018em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist"><span style="top:-0.294em;margin-right:0.1em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x7684;N&#x4E2A;&#x6743;&#x91CD;&#x7CFB;&#x6570;&#x7531;&#x6765;&#xFF1F;</p>
<ul>
<li>&#x6743;&#x91CD;&#x7CFB;&#x6570;&#x901A;&#x8FC7;softmax&#x8BA1;&#x7B97;&#xFF1A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B1;</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>(</mo><msub><mi>e</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>t</mi></mrow></msub><mo>)</mo></mrow><mrow><msubsup><mo>&#x2211;</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mi>exp</mi><mo>(</mo><msub><mi>e</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>k</mi></mrow></msub><mo>)</mo></mrow></mfrac><mo separator="true">,</mo><mspace width="1em"></mspace><mi>t</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">\alpha_{t&apos; t} = \frac{\exp(e_{t&apos; t})}{ \sum_{k=1}^T \exp(e_{t&apos; k}) },\quad t=1,\ldots,T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0184199999999999em;"></span><span class="strut bottom" style="height:1.6726919999999998em;vertical-align:-0.654272em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.429565em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="top:0.074995em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.32101em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.397em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mop mtight">exp</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight">e</span><span class="msupsub"><span class="vlist"><span style="top:0.2620285714285715em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.294em;margin-right:0.1em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4934200000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mop mtight">exp</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight">e</span><span class="msupsub"><span class="vlist"><span style="top:0.2620285714285715em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.294em;margin-right:0.1em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose mtight">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">t</span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>t</mi></mrow></msub><mo>=</mo><mi>g</mi><mo>(</mo><msub><mrow><mi>s</mi></mrow><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mrow><mi>h</mi></mrow><mi>t</mi></msub><mo>)</mo><mo>=</mo><msup><mrow><mi>v</mi></mrow><mi mathvariant="normal">&#x22A4;</mi></msup><mi>tanh</mi><mo>(</mo><msub><mrow><mi>W</mi></mrow><mi>s</mi></msub><mrow><mi>s</mi></mrow><mo>+</mo><msub><mrow><mi>W</mi></mrow><mi>h</mi></msub><mrow><mi>h</mi></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">e_{t&apos; t} = g({s}_{t&apos; - 1}, {h}_t)= {v}^\top \tanh({W}_s {s} + {W}_h {h})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit">s</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x22A4;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord mathit">s</span></span><span class="mbin">+</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">h</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord mathit">h</span></span><span class="mclose">)</span></span></span></span><ul>
<li><strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>t</mi></mrow></msub></mrow><annotation encoding="application/x-tex">e_{t&apos; t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x662F;&#x7531;t&#x65F6;&#x523B;&#x7684;&#x7F16;&#x7801;&#x5668;&#x9690;&#x5C42;&#x72B6;&#x6001;&#x8F93;&#x51FA;&#x548C;&#x89E3;&#x7801;&#x5668;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>t</mi><mrow><msup><mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msup><mo>&#x2212;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t^{&apos;}-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.94248em;"></span><span class="strut bottom" style="height:1.0258099999999999em;vertical-align:-0.08333em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist"><span style="top:-0.431em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle uncramped mtight"><span class="mord scriptscriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2212;</span><span class="mord mathrm">1</span></span></span></span>&#x65F6;&#x523B;&#x7684;&#x9690;&#x5C42;&#x72B6;&#x6001;&#x8F93;&#x51FA;&#x8BA1;&#x7B97;&#x51FA;&#x6765;&#x7684;</strong></li>
<li><strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.43056em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">s</span></span></span></span>&#x4E3A;&#x89E3;&#x7801;&#x5668;&#x9690;&#x5C42;&#x72B6;&#x6001;&#x8F93;&#x51FA;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi></mrow><annotation encoding="application/x-tex">h</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:0.69444em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit">h</span></span></span></span>&#x4E3A;&#x7F16;&#x7801;&#x5668;&#x9690;&#x5C42;&#x72B6;&#x6001;&#x8F93;&#x51FA;</strong></li>
<li><strong><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>v</mi><mo separator="true">,</mo><msub><mi>W</mi><mrow><mi>s</mi></mrow></msub><mo separator="true">,</mo><msub><mi>W</mi><mrow><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">v,W_{s},W_{h}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.8777699999999999em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.13889em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">h</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x90FD;&#x662F;&#x7F51;&#x7EDC;&#x5B66;&#x4E60;&#x7684;&#x53C2;&#x6570;</strong></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="../images/&#x8BA1;&#x7B97;e.png" alt=""></p>
<h3 id="433-&#x673A;&#x5668;&#x7FFB;&#x8BD1;&#x6848;&#x4F8B;">4.3.3 &#x673A;&#x5668;&#x7FFB;&#x8BD1;&#x6848;&#x4F8B;</h3>
<h4 id="4331-&#x95EE;&#x9898;">4.3.3.1 &#x95EE;&#x9898;</h4>
<p>&#x4F7F;&#x7528;&#x7B80;&#x5355;&#x7684;&#x201C;&#x65E5;&#x671F;&#x8F6C;&#x6362;&#x201D;&#x4EFB;&#x52A1;&#x4EE3;&#x66FF;&#x7FFB;&#x8BD1;&#x4EFB;&#x52A1;&#xFF0C;&#x4E3A;&#x4E86;&#x4E0D;&#x7136;&#x8BAD;&#x7EC3;&#x65F6;&#x95F4;&#x53D8;&#x5F97;&#x592A;&#x957F;&#x3002;</p>
<p>&#x7F51;&#x7EDC;&#x5C06;&#x8F93;&#x5165;&#x4EE5;&#x5404;&#x79CD;&#x53EF;&#x80FD;&#x683C;&#x5F0F;&#xFF08;&#x4F8B;&#x5982;&#x201C;1958&#x5E74;8&#x6708;29&#x65E5;&#x201D;&#xFF0C;&#x201C;03/30/1968&#x201D;&#xFF0C;&#x201C;1987&#x5E74;6&#x6708;24&#x65E5;&#x201D;&#xFF09;&#x7F16;&#x5199;&#x7684;&#x65E5;&#x671F;&#xFF0C;&#x5E76;&#x5C06;&#x5176;&#x7FFB;&#x8BD1;&#x6210;&#x6807;&#x51C6;&#x5316;&#x7684;&#x673A;&#x5668;&#x53EF;&#x8BFB;&#x65E5;&#x671F;&#xFF08;&#x4F8B;&#x5982;&#x201C;1958 -08-29&#x201C;&#xFF0C;&#x201D;1968-03-30&#x201C;&#xFF0C;&#x201D;1987-06-24&#x201C;&#xFF09;&#x3002;&#x4F7F;&#x7528;seq2seq&#x7F51;&#x7EDC;&#x5B66;&#x4E60;&#x4EE5;&#x901A;&#x7528;&#x673A;&#x5668;&#x53EF;&#x8BFB;&#x683C;&#x5F0F;YYYY-MM-DD&#x8F93;&#x51FA;&#x65E5;&#x671F;&#x3002;</p>
<h4 id="4332-&#x76F8;&#x5173;&#x73AF;&#x5883;&#x4E0E;&#x7ED3;&#x679C;&#x6F14;&#x793A;">4.3.3.2 &#x76F8;&#x5173;&#x73AF;&#x5883;&#x4E0E;&#x7ED3;&#x679C;&#x6F14;&#x793A;</h4>
<pre><code>pip install faker
pip install tqdm
pip install babel
pip install keras==2.2.4
</code></pre><ul>
<li>faker:&#x751F;&#x6210;&#x6570;&#x636E;&#x5305;</li>
<li>tqdm:python&#x6269;&#x5C55;&#x5305;</li>
<li>babel:&#x4EE3;&#x7801;&#x88C5;&#x6362;&#x5668;</li>
<li>keras:&#x66F4;&#x52A0;&#x65B9;&#x4FBF;&#x7B80;&#x6D01;&#x7684;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x5E93;<ul>
<li>&#x4E3A;&#x4E86;&#x5FEB;&#x901F;&#x7F16;&#x5199;&#x4EE3;&#x7801;</li>
</ul>
</li>
</ul>
<h4 id="4334-&#x4EE3;&#x7801;&#x5206;&#x6790;">4.3.3.4 &#x4EE3;&#x7801;&#x5206;&#x6790;</h4>
<ul>
<li><p>Seq2seq()&#xFF1A;</p>
<ul>
<li>&#x5E8F;&#x5217;&#x6A21;&#x578B;&#x7C7B;</li>
<li>load_data(self,m)&#xFF1A;&#x52A0;&#x8F7D;&#x6570;&#x636E;&#x7C7B;&#xFF0C;&#x9009;&#x62E9;&#x52A0;&#x8F7D;&#x591A;&#x5C11;&#x6761;&#x6570;&#x636E;</li>
<li>init_seq2seq(self)&#xFF1A;&#x521D;&#x59CB;&#x5316;&#x6A21;&#x578B;&#xFF0C;&#x9700;&#x8981;&#x81EA;&#x5B9A;&#x4E49;&#x81EA;&#x5DF1;&#x7684;&#x6A21;&#x578B;<ul>
<li>self.get_encoder(self)&#xFF1A;&#x5B9A;&#x4E49;&#x7F16;&#x7801;&#x5668;</li>
<li>self.get_decoder(self)&#xFF1A;&#x5B9A;&#x4E49;&#x89E3;&#x7801;&#x5668;</li>
<li>self.get_attention(self)&#xFF1A;&#x5B9A;&#x4E49;&#x6CE8;&#x610F;&#x529B;&#x673A;&#x5236;</li>
<li>self.get_output_layer(self)&#xFF1A;&#x5B9A;&#x4E49;&#x89E3;&#x7801;&#x5668;&#x8F93;&#x51FA;&#x5C42;</li>
</ul>
</li>
<li>model(self):&#x5B9A;&#x4E49;&#x6A21;&#x578B;&#x6574;&#x4F53;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x903B;&#x8F91;</li>
<li>train(self, X_onehot, Y_onehot):&#x8BAD;&#x7EC3;&#x6A21;&#x578B;</li>
<li>test(self):&#x6D4B;&#x8BD5;&#x6A21;&#x578B;</li>
</ul>
</li>
<li><p>&#x8BAD;&#x7EC3;</p>
</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:

    s2s = Seq2seq()

    X_onehot, Y_onehot = s2s.load_data(<span class="hljs-number">10000</span>)

    s2s.init_seq2seq()

    s2s.train(X_onehot, Y_onehot)
</code></pre>
<pre><code>&#x6574;&#x4E2A;&#x6570;&#x636E;&#x96C6;&#x7279;&#x5F81;&#x503C;&#x7684;&#x5F62;&#x72B6;: (10000, 30, 37)
&#x6574;&#x4E2A;&#x6570;&#x636E;&#x96C6;&#x76EE;&#x6807;&#x503C;&#x7684;&#x5F62;&#x72B6;: (10000, 10, 11)
&#x67E5;&#x770B;&#x7B2C;&#x4E00;&#x6761;&#x6570;&#x636E;&#x96C6;&#x683C;&#x5F0F;&#xFF1A;&#x7279;&#x5F81;&#x503C;:9 may 1998, &#x76EE;&#x6807;&#x503C;: 1998-05-09
[12  0 24 13 34  0  4 12 12 11 36 36 36 36 36 36 36 36 36 36 36 36 36 36
 36 36 36 36 36 36] [ 2 10 10  9  0  1  6  0  1 10]
one_hot&#x7F16;&#x7801;&#xFF1A; [[0. 0. 0. ... 0. 0. 0.]
 [1. 0. 0. ... 0. 0. 0.]
 [0. 0. 0. ... 0. 0. 0.]
 ...
 [0. 0. 0. ... 0. 0. 1.]
 [0. 0. 0. ... 0. 0. 1.]
 [0. 0. 0. ... 0. 0. 1.]] [[0. 0. 1. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 1. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 1. 0. 0. 0. 0.]
 [1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
 [0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 1.]]
Epoch 1/1
  100/10000 [..............................] - ETA: 10:52 - loss: 23.9884 - dense_1_loss: 2.3992 - dense_1_acc: 0.3200 - dense_1_acc_1: 0.0000e+00 - dense_1_acc_2: 0.0100 - dense_1_acc_3: 0.1300 - dense_1_acc_4: 0.0000e+00 - dense_1_acc_5: 0.0400 - dense_1_acc_6: 0.0900 - dense_1_acc_7: 0.0000e+00 - dense_1_acc_8: 0.3500 - dense_1_acc_9: 0.1100
  200/10000 [..............................] - ETA: 5:27 - loss: 23.9289 - dense_1_loss: 2.3991 - dense_1_acc: 0.2550 - dense_1_acc_1: 0.0000e+00 - dense_1_acc_2: 0.0050 - dense_1_acc_3: 0.1150 - dense_1_acc_4: 0.0950 - dense_1_acc_5: 0.0250 - dense_1_acc_6: 0.1150 - dense_1_acc_7: 0.0800 - dense_1_acc_8: 0.3400 - dense_1_acc_9: 0.1050
</code></pre><ul>
<li>&#x6D4B;&#x8BD5;</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">if</span> __name__ == <span class="hljs-string">&apos;__main__&apos;</span>:

    s2s = Seq2seq()

    X_onehot, Y_onehot = s2s.load_data(<span class="hljs-number">10000</span>)

    s2s.init_seq2seq()

    s2s.train(X_onehot, Y_onehot)

    <span class="hljs-comment"># s2s.test()</span>
</code></pre>
<pre><code class="lang-python">source: <span class="hljs-number">1</span> March <span class="hljs-number">2001</span>
output: <span class="hljs-number">2001</span>-<span class="hljs-number">03</span>-<span class="hljs-number">01</span>
</code></pre>
<h4 id="4335-&#x4EE3;&#x7801;&#x7F16;&#x5199;">4.3.3.5 &#x4EE3;&#x7801;&#x7F16;&#x5199;</h4>
<ul>
<li>1&#x3001;&#x6A21;&#x578B;&#x4E00;&#x4E9B;&#x53C2;&#x6570;&#x786E;&#x5B9A;</li>
</ul>
<pre><code class="lang-python">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">__init__</span><span class="hljs-params">(self, Tx=<span class="hljs-number">30</span>, Ty=<span class="hljs-number">10</span>, n_x=<span class="hljs-number">32</span>, n_y=<span class="hljs-number">64</span>)</span>:</span>
        <span class="hljs-comment"># &#x5B9A;&#x4E49;&#x7F51;&#x7EDC;&#x7684;&#x76F8;&#x5173;&#x53C2;&#x6570;</span>
        self.model_param = {
            <span class="hljs-string">&quot;Tx&quot;</span>: Tx,  <span class="hljs-comment"># &#x5B9A;&#x4E49;encoder&#x5E8F;&#x5217;&#x6700;&#x5927;&#x957F;&#x5EA6;</span>
            <span class="hljs-string">&quot;Ty&quot;</span>: Ty,  <span class="hljs-comment"># decoder&#x5E8F;&#x5217;&#x6700;&#x5927;&#x957F;&#x5EA6;</span>
            <span class="hljs-string">&quot;n_x&quot;</span>: n_x,  <span class="hljs-comment"># encoder&#x7684;&#x9690;&#x5C42;&#x8F93;&#x51FA;&#x503C;&#x5927;&#x5C0F;</span>
            <span class="hljs-string">&quot;n_y&quot;</span>: n_y  <span class="hljs-comment"># decoder&#x7684;&#x9690;&#x5C42;&#x8F93;&#x51FA;&#x503C;&#x5927;&#x5C0F;&#x548C;cell&#x8F93;&#x51FA;&#x503C;&#x5927;&#x5C0F;</span>
        }
</code></pre>
<p>&#x5BF9;&#x4E8E;&#x52A0;&#x8F7D;&#x6570;&#x636E;&#x6765;&#x8BF4;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x9700;&#x8981;&#x53BB;&#x8FDB;&#x884C;&#x7F16;&#x5199;&#x903B;&#x8F91;&#x4E86;&#xFF0C;&#x770B;&#x4E00;&#x4E0B;&#x5927;&#x6982;&#x7684;&#x903B;&#x8F91;.</p>
<ul>
<li>2&#x3001;&#x52A0;&#x8F7D;&#x6570;&#x636E;<ul>
<li>&#x52A0;&#x8F7D;&#x7684;&#x4EE3;&#x7801;&#x903B;&#x8F91;&#x5728;nmt_utils&#x5F53;&#x4E2D;<ul>
<li>from nmt_utils import *</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>&#x6DFB;&#x52A0;&#x4E00;&#x4E9B;&#x53C2;&#x6570;&#x5230;model_param&#x4E2D;</p>
<pre><code class="lang-python"><span class="hljs-comment"># &#x6DFB;&#x52A0;&#x7279;&#x5F81;&#x8BCD;&#x4E2A;&#x4E0D;&#x91CD;&#x590D;&#x4E2A;&#x6570;&#x4EE5;&#x53CA;&#x76EE;&#x6807;&#x8BCD;&#x7684;&#x4E0D;&#x91CD;&#x590D;&#x4E2A;&#x6570;</span>
self.model_param[<span class="hljs-string">&quot;x_vocab&quot;</span>] = x_vocab
self.model_param[<span class="hljs-string">&quot;y_vocab&quot;</span>] = y_vocab

self.model_param[<span class="hljs-string">&quot;x_vocab_size&quot;</span>] = len(x_vocab)
self.model_param[<span class="hljs-string">&quot;y_vocab_size&quot;</span>] = len(y_vocab)
</code></pre>
<p><strong>&#x6211;&#x4EEC;&#x5148;&#x770B;&#x6574;&#x4E2A;&#x8BAD;&#x7EC3;&#x7684;&#x903B;&#x8F91;&#xFF0C;&#x5E76;&#x4ECE;&#x4E2D;&#x6765;&#x5B9E;&#x73B0;&#x6574;&#x4E2A;&#x6A21;&#x578B;&#x7684;&#x5B9A;&#x4E49;&#xFF0C;&#x8BA1;&#x7B97;&#x903B;&#x8F91;</strong></p>
<pre><code class="lang-python">dataset:[(<span class="hljs-string">&apos;9 may 1998&apos;</span>, <span class="hljs-string">&apos;1998-05-09&apos;</span>), (<span class="hljs-string">&apos;10.09.70&apos;</span>, <span class="hljs-string">&apos;1970-09-10&apos;</span>)]
x_vocab:&#x7FFB;&#x8BD1;&#x524D;&#x7684;&#x683C;&#x5F0F;&#x5BF9;&#x5E94;&#x6570;&#x5B57;{<span class="hljs-string">&apos; &apos;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&apos;.&apos;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&apos;/&apos;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&apos;0&apos;</span>: <span class="hljs-number">3</span>, <span class="hljs-string">&apos;1&apos;</span>: <span class="hljs-number">4</span>, <span class="hljs-string">&apos;2&apos;</span>: <span class="hljs-number">5</span>, <span class="hljs-string">&apos;3&apos;</span>: <span class="hljs-number">6</span>, <span class="hljs-string">&apos;4&apos;</span>: <span class="hljs-number">7</span>,...........}
y_vocab:&#x7FFB;&#x8BD1;&#x540E;&#x7684;&#x683C;&#x5F0F;&#x5BF9;&#x5E94;&#x6570;&#x5B57;{<span class="hljs-string">&apos;-&apos;</span>: <span class="hljs-number">0</span>, <span class="hljs-string">&apos;0&apos;</span>: <span class="hljs-number">1</span>, <span class="hljs-string">&apos;1&apos;</span>: <span class="hljs-number">2</span>, <span class="hljs-string">&apos;2&apos;</span>: <span class="hljs-number">3</span>, <span class="hljs-string">&apos;3&apos;</span>: <span class="hljs-number">4</span>, <span class="hljs-string">&apos;4&apos;</span>: <span class="hljs-number">5</span>, <span class="hljs-string">&apos;5&apos;</span>: <span class="hljs-number">6</span>, <span class="hljs-string">&apos;6&apos;</span>: <span class="hljs-number">7</span>, <span class="hljs-string">&apos;7&apos;</span>: <span class="hljs-number">8</span>, <span class="hljs-string">&apos;8&apos;</span>: <span class="hljs-number">9</span>, <span class="hljs-string">&apos;9&apos;</span>: <span class="hljs-number">10</span>}
</code></pre>
<pre><code class="lang-python"><span class="hljs-comment"># &#x6DFB;&#x52A0;&#x7279;&#x5F81;&#x8BCD;&#x4E2A;&#x4E0D;&#x91CD;&#x590D;&#x4E2A;&#x6570;&#x4EE5;&#x53CA;&#x76EE;&#x6807;&#x8BCD;&#x7684;&#x4E0D;&#x91CD;&#x590D;&#x4E2A;&#x6570;</span>
self.model_param[<span class="hljs-string">&quot;x_vocab&quot;</span>] = x_vocab
self.model_param[<span class="hljs-string">&quot;y_vocab&quot;</span>] = y_vocab

self.model_param[<span class="hljs-string">&quot;x_vocab_size&quot;</span>] = len(x_vocab)
self.model_param[<span class="hljs-string">&quot;y_vocab_size&quot;</span>] = len(y_vocab)
</code></pre>
<ul>
<li><p>3&#x3001;&#x8BAD;&#x7EC3;&#x6B65;&#x9AA4;</p>
</li>
<li><ul>
<li>&#xFF08;1&#xFF09;&#x5B9A;&#x4E49;&#x597D;&#x7F51;&#x7EDC;&#x7684;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x683C;&#x5F0F;</li>
<li>&#xFF08;2&#xFF09;&#x5B9A;&#x4E49;&#x597D;&#x4F18;&#x5316;&#x5668;&#xFF08;&#x9009;&#x62E9;Adam&#xFF0C;&#x53C2;&#x6570;lr=0.005, beta_1=0.9, beta_2=0.999, epsilon=None, decay=0.001&#xFF09;<ul>
<li>from keras.optimizers import Adam</li>
<li>model.compile(loss=&apos;categorical_crossentropy&apos;, optimizer=&apos;adam&apos;, metrics=[&apos;accuracy&apos;])</li>
</ul>
</li>
<li>&#xFF08;3&#xFF09;&#x6A21;&#x578B;&#x8BAD;&#x7EC3;,<ul>
<li>model.fit(inputs, outputs, epochs=1,batch_size=100)</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="lang-python">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">train</span><span class="hljs-params">(self, X_onehot, Y_onehot)</span>:</span>
        <span class="hljs-string">&quot;&quot;&quot;
        &#x8BAD;&#x7EC3;
        :param X_onehot: &#x7279;&#x5F81;&#x503C;&#x7684;one_hot&#x7F16;&#x7801;
        :param Y_onehot: &#x76EE;&#x6807;&#x503C;&#x7684;one_hot&#x7F16;&#x7801;
        :return:
        &quot;&quot;&quot;</span>
        <span class="hljs-comment"># &#x5229;&#x7528;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;&#x5B9A;&#x4E49;&#x597D;&#x6A21;&#x578B;&#x8F93;&#x5165;&#x8F93;&#x51FA;</span>
        model = self.model()

        opt = Adam(lr=<span class="hljs-number">0.005</span>, beta_1=<span class="hljs-number">0.9</span>, beta_2=<span class="hljs-number">0.999</span>, epsilon=<span class="hljs-keyword">None</span>, decay=<span class="hljs-number">0.001</span>)
        model.compile(loss=<span class="hljs-string">&apos;categorical_crossentropy&apos;</span>, optimizer=<span class="hljs-string">&apos;adam&apos;</span>, metrics=[<span class="hljs-string">&apos;accuracy&apos;</span>])

        s0 = np.zeros((<span class="hljs-number">10000</span>, self.model_param[<span class="hljs-string">&quot;n_y&quot;</span>]))
        c0 = np.zeros((<span class="hljs-number">10000</span>, self.model_param[<span class="hljs-string">&quot;n_y&quot;</span>]))
        outputs = list(Y_onehot.swapaxes(<span class="hljs-number">0</span>, <span class="hljs-number">1</span>))

        <span class="hljs-comment"># &#x8F93;&#x5165;x,&#x4EE5;&#x53CA;decoder&#x4E2D;LSTM&#x7684;&#x4E24;&#x4E2A;&#x521D;&#x59CB;&#x5316;&#x503C;</span>
        model.fit([X_onehot, s0, c0], outputs, epochs=<span class="hljs-number">1</span>, batch_size=<span class="hljs-number">100</span>)

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">None</span>
</code></pre>
<ul>
<li>&#xFF08;1&#xFF09;&#x5B9A;&#x4E49;&#x7F51;&#x7EDC;&#x597D;&#x7684;&#x8F93;&#x5165;&#x5230;&#x8F93;&#x51FA;&#x6D41;&#x7A0B;<ul>
<li>&#x6B65;&#x9AA4;1&#x3001;&#x5B9A;&#x4E49;&#x6A21;&#x578B;&#x7684;&#x8F93;&#x5165;</li>
<li>&#x6B65;&#x9AA4;2&#xFF1A;&#x4F7F;&#x7528;encoder&#x7684;&#x53CC;&#x5411;LSTM&#x7ED3;&#x6784;&#x5F97;&#x8F93;&#x51FA;a</li>
<li>&#x6B65;&#x9AA4;3&#xFF1A;&#x5FAA;&#x73AF;decoder&#x7684;Ty&#x6B21;&#x5E8F;&#x5217;&#x8F93;&#x5165;&#xFF0C;&#x83B7;&#x53D6;decoder&#x6700;&#x540E;&#x8F93;&#x51FA;<ul>
<li>1: &#x5B9A;&#x4E49;decoder&#x7B2C;t&apos;&#x65F6;&#x523B;&#x7684;&#x6CE8;&#x610F;&#x529B;&#x7ED3;&#x6784;&#x5E76;&#x8F93;&#x51FA;context<ul>
<li>context = self.computer_one_attention(a, s)(&#x9700;&#x8981;&#x5B9E;&#x73B0;Attention&#x7ED3;&#x6784;&#x7684;&#x8BA1;&#x7B97;&#x8FC7;&#x7A0B;)</li>
</ul>
</li>
<li>2: &#x5BF9;&quot;context&quot; &#x548C;&#x521D;&#x59CB;&#x4E24;&#x4E2A;&#x72B6;&#x6001;s0,c0&#x8F93;&#x5165;&#x5230;deocder&#x5F53;&#x4E2D;,&#x8FD4;&#x56DE;&#x4E24;&#x4E2A;&#x8F93;&#x51FA;<ul>
<li>s, _, c = self.decoder(context, initial_state=[s, c])</li>
</ul>
</li>
<li>3: &#x5E94;&#x7528; Dense layere&#x83B7;&#x53D6;deocder&#x7684;t&apos;&#x65F6;&#x523B;&#x7684;&#x8F93;&#x51FA;
out = self.output_layer(s)</li>
</ul>
</li>
<li>&#x6B65;&#x9AA4; 4: &#x521B;&#x5EFA;model&#x5B9E;&#x4F8B;&#xFF0C;&#x5B9A;&#x4E49;&#x8F93;&#x5165;&#x8F93;&#x51FA;<ul>
<li>from keras.models import Model</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="../images/%E7%BF%BB%E8%AF%91%E7%BB%93%E6%9E%84.png" alt=""></p>
<pre><code class="lang-python">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">model</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-string">&quot;&quot;&quot;
        &#x5B9A;&#x4E49;&#x6A21;&#x578B;&#x83B7;&#x53D6;&#x6A21;&#x578B;&#x5B9E;&#x4F8B;
        :param model_param: &#x7F51;&#x7EDC;&#x7684;&#x76F8;&#x5173;&#x53C2;&#x6570;
        :param seq2seq:&#x7F51;&#x7EDC;&#x7ED3;&#x6784;
        :return: model,Keras model instance
        &quot;&quot;&quot;</span>
        <span class="hljs-comment"># &#x6B65;&#x9AA4;1&#x3001;&#x5B9A;&#x4E49;&#x6A21;&#x578B;&#x7684;&#x8F93;&#x5165;</span>
        <span class="hljs-comment"># &#x5B9A;&#x4E49;decoder&#x4E2D;&#x9690;&#x5C42;&#x521D;&#x59CB;&#x72B6;&#x6001;&#x503C;s0&#x4EE5;&#x53CA;cell&#x8F93;&#x51FA;c0</span>
        X = Input(shape=(self.model_param[<span class="hljs-string">&quot;Tx&quot;</span>], self.model_param[<span class="hljs-string">&quot;x_vocab_size&quot;</span>]), name=<span class="hljs-string">&apos;X&apos;</span>)

        <span class="hljs-comment"># &#x5B9A;&#x4E49;deocder&#x521D;&#x59CB;&#x5316;&#x72B6;&#x6001;</span>
        s0 = Input(shape=(self.model_param[<span class="hljs-string">&quot;n_y&quot;</span>],), name=<span class="hljs-string">&apos;s0&apos;</span>)
        c0 = Input(shape=(self.model_param[<span class="hljs-string">&quot;n_y&quot;</span>],), name=<span class="hljs-string">&apos;c0&apos;</span>)
        s = s0
        c = c0

        <span class="hljs-comment"># &#x5B9A;&#x4E49;&#x88C5;&#x6709;&#x8F93;&#x51FA;&#x503C;&#x7684;&#x5217;&#x8868;</span>
        outputs = []

        <span class="hljs-comment"># &#x6B65;&#x9AA4;2&#xFF1A;&#x4F7F;&#x7528;encoder&#x7684;&#x53CC;&#x5411;LSTM&#x7ED3;&#x6784;&#x5F97;&#x8F93;&#x51FA;a</span>
        a = self.encoder(X)

        <span class="hljs-comment"># &#x6B65;&#x9AA4;3&#xFF1A;&#x5FAA;&#x73AF;decoder&#x7684;Ty&#x6B21;&#x5E8F;&#x5217;&#x8F93;&#x5165;&#xFF0C;&#x83B7;&#x53D6;decoder&#x6700;&#x540E;&#x8F93;&#x51FA;</span>
        <span class="hljs-comment"># &#x5305;&#x62EC;&#x8BA1;&#x7B97;Attention&#x8F93;&#x51FA;</span>
        <span class="hljs-keyword">for</span> t <span class="hljs-keyword">in</span> range(self.model_param[<span class="hljs-string">&quot;Ty&quot;</span>]):
            <span class="hljs-comment"># 1: &#x5B9A;&#x4E49;decoder&#x7B2C;t&apos;&#x65F6;&#x523B;&#x7684;&#x6CE8;&#x610F;&#x529B;&#x7ED3;&#x6784;&#x5E76;&#x8F93;&#x51FA;context</span>
            context = self.computer_one_attention(a, s)

            <span class="hljs-comment"># 2: &#x5BF9;&quot;context&quot; vector&#x8F93;&#x5165;&#x5230;deocder&#x5F53;&#x4E2D;</span>
            <span class="hljs-comment"># &#x83B7;&#x53D6;cell&#x7684;&#x4E24;&#x4E2A;&#x8F93;&#x51FA;&#x9690;&#x5C42;&#x72B6;&#x6001;&#x548C;&#xFF0C;initial_state= [previous hidden state, previous cell state]</span>
            s, _, c = self.decoder(context, initial_state=[s, c])

            <span class="hljs-comment"># 3: &#x5E94;&#x7528; Dense layere&#x83B7;&#x53D6;deocder&#x7684;t&apos;&#x65F6;&#x523B;&#x7684;&#x8F93;&#x51FA;</span>
            out = self.output_layer(s)

            <span class="hljs-comment"># 4: &#x5C06;decoder&#x4E2D;t&apos;&#x65F6;&#x523B;&#x7684;&#x8F93;&#x51FA;&#x88C5;&#x5165;&#x5217;&#x8868;</span>
            outputs.append(out)

        <span class="hljs-comment"># &#x6B65;&#x9AA4; 4: &#x521B;&#x5EFA;model&#x5B9E;&#x4F8B;&#xFF0C;&#x5B9A;&#x4E49;&#x8F93;&#x5165;&#x8F93;&#x51FA;</span>
        model = Model(inputs=(X, s0, c0), outputs=outputs)

        <span class="hljs-keyword">return</span> model
</code></pre>
<ul>
<li>3&#x3001;&#x6A21;&#x578B;&#x521D;&#x59CB;&#x5316;&#x6A21;&#x578B;&#x7ED3;&#x6784;&#x5B9A;&#x4E49;<ul>
<li>&#x5728;&#x8BAD;&#x7EC3;&#x4E2D;&#x6709;&#x4E00;&#x4E9B;&#x6A21;&#x578B;&#x7ED3;&#x6784;&#xFF0C;&#x6240;&#x4EE5;&#x73B0;&#x9700;&#x8981;&#x5B9A;&#x4E49;&#x8FD9;&#x4E9B;&#x7ED3;&#x6784;&#x7EDF;&#x4E00;&#x521D;&#x59CB;&#x5316;&#xFF0C;&#x8FD9;&#x4E9B;&#x6A21;&#x578B;&#x7ED3;&#x6784;&#x4F5C;&#x4E3A;&#x6574;&#x4E2A;Seq2Seq&#x7C7B;&#x7684;&#x5C5E;&#x6027;&#xFF0C;&#x521D;&#x59CB;&#x5316;&#x903B;&#x8F91;&#x3002;</li>
</ul>
</li>
</ul>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">init_seq2seq</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    &#x521D;&#x59CB;&#x5316;&#x7F51;&#x7EDC;&#x7ED3;&#x6784;
    :return:
    &quot;&quot;&quot;</span>
    <span class="hljs-comment"># &#x6DFB;&#x52A0;encoder&#x5C5E;&#x6027;</span>
    self.get_encoder()

    <span class="hljs-comment"># &#x6DFB;&#x52A0;decoder&#x5C5E;&#x6027;</span>
    self.get_decoder()

    <span class="hljs-comment"># &#x6DFB;&#x52A0;attention&#x5C5E;&#x6027;</span>
    self.get_attention()

    <span class="hljs-comment"># &#x6DFB;&#x52A0;get_output_layer&#x5C5E;&#x6027;</span>
    self.get_output_layer()

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">None</span>
</code></pre>
<ul>
<li>&#x5B9A;&#x4E49;&#x7F16;&#x89E3;&#x7801;&#x5668;&#x3001;Attention&#x673A;&#x5236;&#x3001;&#x8F93;&#x51FA;&#x5C42;</li>
</ul>
<p><img src="../images/%E7%BF%BB%E8%AF%91%E7%BB%93%E6%9E%84.png" alt=""></p>
<p>Keras&#x662F;&#x4E00;&#x4E2A;&#x9AD8;&#x7EA7;&#x795E;&#x7ECF;&#x7F51;&#x7EDC;API&#xFF0C;&#x7528;Python&#x7F16;&#x5199;&#xFF0C;&#x80FD;&#x591F;&#x5728;TensorFlow&#x4E4B;&#x4E0A;&#x8FD0;&#x884C;&#x3002;&#x5B83;&#x7684;&#x5F00;&#x53D1;&#x91CD;&#x70B9;&#x662F;&#x5B9E;&#x73B0;&#x5FEB;&#x901F;&#x5B9E;&#x9A8C;&#x3002;&#x80FD;&#x591F;&#x4EE5;&#x6700;&#x5C0F;&#x7684;&#x5EF6;&#x8FDF;&#x4ECE;&#x60F3;&#x6CD5;&#x5230;&#x7ED3;&#x679C;&#x662F;&#x8FDB;&#x884C;&#x826F;&#x597D;&#x7814;&#x7A76;&#x7684;&#x5173;&#x952E;&#x3002;</p>
<p>&#x5982;&#x679C;&#x60A8;&#x9700;&#x8981;&#x6DF1;&#x5EA6;&#x5B66;&#x4E60;&#x5E93;&#xFF0C;&#x8BF7;&#x4F7F;&#x7528;Keras&#xFF1A;&#x5141;&#x8BB8;&#x7B80;&#x5355;&#x5FEB;&#x901F;&#x7684;&#x539F;&#x578B;&#x8BBE;&#x8BA1;&#xFF08;&#x901A;&#x8FC7;&#x7528;&#x6237;&#x53CB;&#x597D;&#x6027;&#xFF0C;&#x6A21;&#x5757;&#x5316;&#x548C;&#x53EF;&#x6269;&#x5C55;&#x6027;&#xFF09;</p>
<ul>
<li>&#x7F16;&#x7801;&#x5668;<ul>
<li>&#x7F16;&#x7801;&#x5668;&#xFF1A;&#x4F7F;&#x7528;&#x53CC;&#x5411;LSTM&#xFF08;&#x9690;&#x5C42;&#x4F20;&#x9012;&#x6709;&#x53CC;&#x5411;&#x503C;&#x4F20;&#x9012;&#xFF09;</li>
<li>from keras.layers import LSTM, Bidirectional</li>
<li><strong>LSTM(units, return_sequences=False,name=&quot;&quot;)</strong><ul>
<li>units: &#x6B63;&#x6574;&#x6570;, units&#x72B6;&#x6001;&#x8F93;&#x51FA;&#x7684;&#x7EF4;&#x5EA6;</li>
<li>return_sequences:&#x5E03;&#x5C14;&#x7C7B;&#x578B; &#x662F;&#x5426;&#x8FD4;&#x56DE;&#x8F93;&#x51FA;&#x5E8F;&#x5217;</li>
<li>return:LSTM layer</li>
</ul>
</li>
<li>Bidirectional(layer, merge_mode=&apos;concat&apos;)<ul>
<li>&#x5BF9;RNN&#x3001;LSTM&#x8FDB;&#x884C;&#x53CC;&#x5411;&#x88C5;&#x9970;</li>
<li>layer:RNN layer&#x6216;&#x8005;LSTM layer</li>
<li>merge_mode:&#x5C06;RNN/LSTM&#x7684;&#x524D;&#x5411;&#x548C;&#x540E;&#x5411;&#x8F93;&#x51FA;&#x503C;&#x8FDB;&#x884C;&#x5408;&#x5E76;<ul>
<li>{&apos;sum&apos;, &apos;mul&apos;, &apos;<strong>concat</strong>&apos;, &apos;ave&apos;, None}</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="lang-python">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_encoder</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-string">&quot;&quot;&quot;
        &#x5B9A;&#x4E49;&#x7F16;&#x7801;&#x5668;&#x7ED3;&#x6784;
        :return:
        &quot;&quot;&quot;</span>
        <span class="hljs-comment"># &#x6307;&#x5B9A;&#x9690;&#x5C42;&#x503C;&#x8F93;&#x51FA;&#x7684;&#x5927;&#x5C0F;</span>

        self.encoder = Bidirectional(LSTM(self.model_param[<span class="hljs-string">&quot;n_x&quot;</span>], return_sequences=<span class="hljs-keyword">True</span>, name=<span class="hljs-string">&apos;bidirectional_1&apos;</span>), merge_mode=<span class="hljs-string">&apos;concat&apos;</span>)

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">None</span>
</code></pre>
<ul>
<li>&#x89E3;&#x7801;&#x5668;<ul>
<li><strong>return_state</strong>: &#x5E03;&#x5C14;&#xFF0C;&#x662F;&#x5426;&#x8FD4;&#x56DE;&#x8F93;&#x51FA;&#x4EE5;&#x53CA;&#x72B6;&#x6001;&#x503C;<ul>
<li>if return_state: &#x7B2C;&#x4E00;&#x4E2A;&#x503C;&#x662F;output. &#x540E;&#x9762;&#x7684;&#x503C;&#x662F;&#x72B6;&#x6001;&#x503C;shape &#x4E3A; (batch_size, units).</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="lang-python">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_decoder</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-string">&quot;&quot;&quot;
        &#x5B9A;&#x4E49;&#x89E3;&#x7801;&#x5668;&#x7ED3;&#x6784;
        :return:
        &quot;&quot;&quot;</span>
        <span class="hljs-comment"># &#x5B9A;&#x4E49;decoder&#x7ED3;&#x6784;&#xFF0C;&#x6307;&#x5B9A;&#x9690;&#x5C42;&#x503C;&#x7684;&#x5F62;&#x72B6;&#x5927;&#x5C0F;&#xFF0C;return_state=True</span>
        self.decoder = LSTM(self.model_param[<span class="hljs-string">&quot;n_y&quot;</span>], return_state=<span class="hljs-keyword">True</span>)

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">None</span>
</code></pre>
<ul>
<li>&#x8F93;&#x51FA;&#x5C42;<ul>
<li>from keras.layer import Dense</li>
<li>&#x6307;&#x5B9A;&#x4E00;&#x4E2A;&#x666E;&#x901A;&#x7684;&#x5168;&#x8FDE;&#x63A5;&#x5C42;&#xFF0C;&#x5E76;&#x4E14;&#x53EF;&#x4EE5;&#x6307;&#x5B9A;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;</li>
<li>Dense(units, activation=None)<ul>
<li>&#x795E;&#x7ECF;&#x5143;&#x4E2A;&#x6570;&#xFF08;&#x8F93;&#x51FA;&#x5927;&#x5C0F;&#xFF09;</li>
<li>activation=None&#xFF1A;&#x6FC0;&#x6D3B;&#x51FD;&#x6570;</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="lang-python">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_output_layer</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-string">&quot;&quot;&quot;
        &#x5B9A;&#x4E49;&#x8F93;&#x51FA;&#x5C42;
        :return: output_layer
        &quot;&quot;&quot;</span>

        <span class="hljs-comment"># &#x5BF9;decoder&#x8F93;&#x51FA;&#x8FDB;&#x884C;softmax&#xFF0C;&#x8F93;&#x51FA;&#x5411;&#x91CF;&#x5927;&#x5C0F;&#x4E3A;y_vocab&#x5927;&#x5C0F;</span>
        self.output_layer = Dense(self.model_param[<span class="hljs-string">&quot;y_vocab_size&quot;</span>], activation=softmax)

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">None</span>
</code></pre>
<ul>
<li>computer_one_attention&#x51FD;&#x6570;&#x5B9E;&#x73B0;&#xFF1A;attention&#x5C42;&#x7ED3;&#x6784;<ul>
<li>1&#x3001;&#x5B9A;&#x4E49;&#x7ED3;&#x6784;</li>
<li>2&#x3001;&#x5B9E;&#x73B0;&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x7ED3;&#x679C;</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>&#x3B1;</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>t</mi></mrow></msub><mo>=</mo><mfrac><mrow><mi>exp</mi><mo>(</mo><msub><mi>e</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>t</mi></mrow></msub><mo>)</mo></mrow><mrow><msubsup><mo>&#x2211;</mo><mrow><mi>k</mi><mo>=</mo><mn>1</mn></mrow><mi>T</mi></msubsup><mi>exp</mi><mo>(</mo><msub><mi>e</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>k</mi></mrow></msub><mo>)</mo></mrow></mfrac><mo separator="true">,</mo><mspace width="1em"></mspace><mi>t</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mo>&#x2026;</mo><mo separator="true">,</mo><mi>T</mi></mrow><annotation encoding="application/x-tex">\alpha_{t&apos; t} = \frac{\exp(e_{t&apos; t})}{ \sum_{k=1}^T \exp(e_{t&apos; k}) },\quad t=1,\ldots,T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.0184199999999999em;"></span><span class="strut bottom" style="height:1.6726919999999998em;vertical-align:-0.654272em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.0037em;">&#x3B1;</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.0037em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.429565em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="top:0.074995em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.32101em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.397em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.13889em;">T</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mop mtight">exp</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight">e</span><span class="msupsub"><span class="vlist"><span style="top:0.2620285714285715em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.294em;margin-right:0.1em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose mtight">)</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.4934200000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mop mtight">exp</span><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathit mtight">e</span><span class="msupsub"><span class="vlist"><span style="top:0.2620285714285715em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.294em;margin-right:0.1em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose mtight">)</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mpunct">,</span><span class="mord mathit"><span class="mspace quad"></span><span class="mord mathit">t</span></span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="minner">&#x2026;</span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.13889em;">T</span></span></span></span></li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>e</mi><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>t</mi></mrow></msub><mo>=</mo><mi>g</mi><mo>(</mo><msub><mrow><mi>s</mi></mrow><mrow><msup><mi>t</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo>&#x2212;</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mrow><mi>h</mi></mrow><mi>t</mi></msub><mo>)</mo><mo>=</mo><msup><mrow><mi>v</mi></mrow><mi mathvariant="normal">&#x22A4;</mi></msup><mi>tanh</mi><mo>(</mo><msub><mrow><mi>W</mi></mrow><mi>s</mi></msub><mrow><mi>s</mi></mrow><mo>+</mo><msub><mrow><mi>W</mi></mrow><mi>h</mi></msub><mrow><mi>h</mi></mrow><mo>)</mo></mrow><annotation encoding="application/x-tex">e_{t&apos; t} = g({s}_{t&apos; - 1}, {h}_t)= {v}^\top \tanh({W}_s {s} + {W}_h {h})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">e</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit">s</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin mtight">&#x2212;</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit">h</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">t</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.03588em;">v</span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord mathrm mtight">&#x22A4;</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mop">tanh</span><span class="mopen">(</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">s</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord mathit">s</span></span><span class="mbin">+</span><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.13889em;">W</span></span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">h</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord textstyle uncramped"><span class="mord mathit">h</span></span><span class="mclose">)</span></span></span></span></li>
</ul>
</li>
</ul>
<p><img src="../images/attention%E7%BB%93%E6%9E%84.png" alt=""></p>
<ul>
<li>from keras.layers import RepeatVector, Concatenate, Dot, Activation</li>
</ul>
<pre><code class="lang-python">    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">get_attention</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-string">&quot;&quot;&quot;
        &#x5B9A;&#x4E49;Attention&#x7684;&#x7ED3;&#x6784;
        :return: attention&#x7ED3;&#x6784;
        &quot;&quot;&quot;</span>
        <span class="hljs-comment"># &#x5B9A;&#x4E49;RepeatVector&#x590D;&#x5236;&#x6210;&#x591A;&#x4E2A;&#x7EF4;&#x5EA6;</span>
        repeator = RepeatVector(self.model_param[<span class="hljs-string">&quot;Tx&quot;</span>])

        <span class="hljs-comment"># &#x8FDB;&#x884C;&#x77E9;&#x9635;&#x62FC;&#x63A5;</span>
        concatenator = Concatenate(axis=-<span class="hljs-number">1</span>)

        <span class="hljs-comment"># &#x8FDB;&#x884C;&#x5168;&#x8FDE;&#x63A5;&#x5C42;10&#x4E2A;&#x795E;&#x7ECF;&#x5143;</span>
        densor1 = Dense(<span class="hljs-number">10</span>, activation=<span class="hljs-string">&quot;tanh&quot;</span>, name=<span class="hljs-string">&apos;Dense1&apos;</span>)

        <span class="hljs-comment"># &#x63A5;&#x7740;relu&#x51FD;&#x6570;</span>
        densor2 = Dense(<span class="hljs-number">1</span>, activation=<span class="hljs-string">&quot;relu&quot;</span>, name=<span class="hljs-string">&apos;Dense2&apos;</span>)

        <span class="hljs-comment"># softmax</span>
        activator = Activation(softmax,
                               name=<span class="hljs-string">&apos;attention_weights&apos;</span>)
        <span class="hljs-comment"># context&#x8BA1;&#x7B97;</span>
        dotor = Dot(axes=<span class="hljs-number">1</span>)

        <span class="hljs-comment"># &#x5C06;&#x7ED3;&#x6784;&#x5B58;&#x50A8;&#x5728;attention&#x5F53;&#x4E2D;</span>
        self.attention = {
            <span class="hljs-string">&quot;repeator&quot;</span>: repeator,
            <span class="hljs-string">&quot;concatenator&quot;</span>: concatenator,
            <span class="hljs-string">&quot;densor1&quot;</span>: densor1,
            <span class="hljs-string">&quot;densor2&quot;</span>: densor2,
            <span class="hljs-string">&quot;activator&quot;</span>: activator,
            <span class="hljs-string">&quot;dotor&quot;</span>: dotor
        }

        <span class="hljs-keyword">return</span> <span class="hljs-keyword">None</span>
</code></pre>
<ul>
<li>Attention&#x8F93;&#x5165;&#x8F93;&#x51FA;&#x903B;&#x8F91;<ul>
<li>&#x4F7F;&#x7528;Attention&#x7ED3;&#x6784;&#x53BB;&#x5B9E;&#x73B0;&#x8F93;&#x5165;&#x5230;&#x8F93;&#x51FA;&#x7684;&#x903B;&#x8F91;</li>
</ul>
</li>
</ul>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">computer_one_attention</span><span class="hljs-params">(self, a, s_prev)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    &#x5229;&#x7528;&#x5B9A;&#x4E49;&#x597D;&#x7684;attention&#x7ED3;&#x6784;&#x8BA1;&#x7B97;&#x4E2D;&#x7684;alpha&#x7CFB;&#x6570;&#x4E0E;a&#x5BF9;&#x5E94;&#x8F93;&#x51FA;
    :param a:&#x9690;&#x5C42;&#x72B6;&#x6001;&#x503C; (m, Tx, 2*n_a)
    :param s_prev: LSTM&#x7684;&#x521D;&#x59CB;&#x9690;&#x5C42;&#x72B6;&#x6001;&#x503C;&#xFF0C; &#x5F62;&#x72B6;(sample, n_s)
    :return: context
    &quot;&quot;&quot;</span>
    <span class="hljs-comment"># &#x4F7F;&#x7528;repeator&#x6269;&#x5927;&#x6570;&#x636E;s_prev&#x7684;&#x7EF4;&#x5EA6;&#x4E3A;(sample, Tx, n_y)&#xFF0C;&#x8FD9;&#x6837;&#x53EF;&#x4EE5;&#x4E0E;a&#x8FDB;&#x884C;&#x5408;&#x5E76;</span>
    s_prev = self.attention[<span class="hljs-string">&quot;repeator&quot;</span>](s_prev)

    <span class="hljs-comment"># &#x5C06;a&#x548C;s_prev &#x6309;&#x7167;&#x6700;&#x540E;&#x4E00;&#x4E2A;&#x7EF4;&#x5EA6;&#x8FDB;&#x884C;&#x5408;&#x5E76;&#x8BA1;&#x7B97;</span>
    concat = self.attention[<span class="hljs-string">&quot;concatenator&quot;</span>]([a, s_prev])

    <span class="hljs-comment"># &#x4F7F;&#x7528;densor1&#x5168;&#x8FDE;&#x63A5;&#x5C42;&#x7F51;&#x7EDC;&#x8BA1;&#x7B97;&#x51FA;e</span>
    e = self.attention[<span class="hljs-string">&quot;densor1&quot;</span>](concat)

    <span class="hljs-comment"># &#x4F7F;&#x7528;densor2&#x589E;&#x52A0;relu&#x6FC0;&#x6D3B;&#x51FD;&#x6570;&#x8BA1;&#x7B97;</span>
    energies = self.attention[<span class="hljs-string">&quot;densor2&quot;</span>](e)

    <span class="hljs-comment"># &#x4F7F;&#x7528;&quot;activator&quot;&#x7684;softmax&#x51FD;&#x6570;&#x8BA1;&#x7B97;&#x6743;&#x91CD;&quot;alphas&quot;</span>
    <span class="hljs-comment"># &#x8FD9;&#x6837;&#x4E00;&#x4E2A;attention&#x7684;&#x7CFB;&#x6570;&#x8BA1;&#x7B97;&#x5B8C;&#x6210;</span>
    alphas = self.attention[<span class="hljs-string">&quot;activator&quot;</span>](energies)

    <span class="hljs-comment"># &#x4F7F;&#x7528;dotor,&#x77E9;&#x9635;&#x4E58;&#x6CD5;&#xFF0C;&#x5C06; &quot;alphas&quot; and &quot;a&quot; &#x53BB;&#x8BA1;&#x7B97;context/c</span>
    context = self.attention[<span class="hljs-string">&quot;dotor&quot;</span>]([alphas, a])

    <span class="hljs-keyword">return</span> context
</code></pre>
<ul>
<li>4&#x3001;&#x6D4B;&#x8BD5;&#x903B;&#x8F91;<ul>
<li>model.load_weights(path):&#x52A0;&#x8F7D;&#x6A21;&#x578B;</li>
</ul>
</li>
</ul>
<pre><code class="lang-python"><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">test</span><span class="hljs-params">(self)</span>:</span>
    <span class="hljs-string">&quot;&quot;&quot;
    &#x6D4B;&#x8BD5;
    :return:
    &quot;&quot;&quot;</span>
    model = self.model()

    model.load_weights(<span class="hljs-string">&quot;./models/model.h5&quot;</span>)

    example = <span class="hljs-string">&apos;1 March 2001&apos;</span>
    source = string_to_int(example, self.model_param[<span class="hljs-string">&quot;Tx&quot;</span>], self.model_param[<span class="hljs-string">&quot;x_vocab&quot;</span>])
    source = np.expand_dims(np.array(list(map(<span class="hljs-keyword">lambda</span> x:
                                              to_categorical(x, num_classes=self.model_param[<span class="hljs-string">&quot;x_vocab_size&quot;</span>]),
                                              source))), axis=<span class="hljs-number">0</span>)
    s0 = np.zeros((<span class="hljs-number">10000</span>, self.model_param[<span class="hljs-string">&quot;n_y&quot;</span>]))
    c0 = np.zeros((<span class="hljs-number">10000</span>, self.model_param[<span class="hljs-string">&quot;n_y&quot;</span>]))
    prediction = model.predict([source, s0, c0])
    prediction = np.argmax(prediction, axis=-<span class="hljs-number">1</span>)

    output = [dict(zip(self.model_param[<span class="hljs-string">&quot;y_vocab&quot;</span>].values(), self.model_param[<span class="hljs-string">&quot;y_vocab&quot;</span>].keys()))[int(i)] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> prediction]

    print(<span class="hljs-string">&quot;source:&quot;</span>, example)
    print(<span class="hljs-string">&quot;output:&quot;</span>, <span class="hljs-string">&apos;&apos;</span>.join(output))

    <span class="hljs-keyword">return</span> <span class="hljs-keyword">None</span>
</code></pre>
<h3 id="434-&#x96C6;&#x675F;&#x641C;&#x7D22;&#xFF08;beam-search&#xFF09;">4.3.4 &#x96C6;&#x675F;&#x641C;&#x7D22;&#xFF08;Beam Search&#xFF09;</h3>
<h4 id="4341-&#x95EE;&#x9898;&#x5F15;&#x5165;">4.3.4.1 &#x95EE;&#x9898;&#x5F15;&#x5165;</h4>
<p>&#x6211;&#x4EEC;&#x5728;&#x627E;&#x5230;&#x4E00;&#x4E2A;&#x5408;&#x9002;&#x7684;&#x53E5;&#x5B50;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x4E00;&#x4E2A;&#x5F88;&#x76F4;&#x89C2;&#x7684;&#x65B9;&#x6CD5;&#x662F;&#x5728;&#x751F;&#x6210;&#x7B2C;&#x4E00;&#x4E2A;&#x8BCD;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mrow><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">y^{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x5206;&#x5E03;&#x4E4B;&#x540E;&#xFF0C;&#x6839;&#x636E;&#x6761;&#x4EF6;&#x8BED;&#x8A00;&#x6A21;&#x578B;&#x6311;&#x9009;&#x51FA;&#x6700;&#x6709;&#x53EF;&#x80FD;&#x7684;&#x7B2C;&#x4E00;&#x4E2A;&#x8BCD;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mrow><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">y^{1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> &#xFF0C;&#x7136;&#x540E;&#x751F;&#x6210;&#x7B2C;&#x4E8C;&#x4E2A;&#x8BCD;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mrow><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">y^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x7684;&#x6982;&#x7387;&#x5206;&#x5E03;&#x6311;&#x9009;&#x7B2C;&#x4E8C;&#x4E2A;&#x8BCD;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mrow><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">y^{2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#xFF0C;&#x4F9D;&#x6B64;&#x7C7B;&#x63A8;&#xFF0C;&#x59CB;&#x7EC8;&#x662F;&#x9009;&#x62E9;&#x6BCF;&#x4E00;&#x4E2A;&#x6700;&#x5927;&#x6982;&#x7387;&#x7684;&#x8BCD;&#xFF0C;&#x8FD9;&#x79CD;&#x65B9;&#x6CD5;&#x5728;&#x673A;&#x5668;&#x7FFB;&#x8BD1;&#x9886;&#x57DF;&#x5176;&#x5B9E;&#x5E76;&#x4E0D;&#x7BA1;&#x7528;&#xFF0C;&#x6211;&#x4EEC;&#x6765;&#x4E3E;&#x4E2A;&#x4F8B;&#x5B50;</p>
<pre><code class="lang-python">&#x6CD5;&#x8BED;&#x53E5;&#x5B50;<span class="hljs-string">&quot;Jane visite l&apos;Afrique en septembre.&quot;</span>
&#x7FFB;&#x8BD1;<span class="hljs-number">1</span>-Jane <span class="hljs-keyword">is</span> visiting Africa <span class="hljs-keyword">in</span> September.
&#x7FFB;&#x8BD1;<span class="hljs-number">2</span>-Jane <span class="hljs-keyword">is</span> going to be visiting Africa <span class="hljs-keyword">in</span> September.
</code></pre>
<p>&#x7FFB;&#x8BD1;1&#x663E;&#x7136;&#x6BD4;&#x7FFB;&#x8BD1;2&#x8981;&#x66F4;&#x597D;&#xFF0C;&#x66F4;&#x52A0;&#x7B80;&#x6D01;&#x7684;&#x8868;&#x8FBE;&#x4E86;&#x610F;&#x601D;&#x3002;</p>
<p>&#x5982;&#x679C;&#x8BE5;&#x7B97;&#x6CD5;&#x6311;&#x9009;&#x4E86; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mrow><mn>1</mn></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mn>2</mn></mrow></msup></mrow><annotation encoding="application/x-tex">y^{1},y^{2} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>, (&apos;Jane&apos; , &apos;is&apos;)&#xFF0C;&#x90A3;&#x4E48;&#x5728;&#x82F1;&#x8BED;&#x4E2D;&quot;is going&quot;&#x66F4;&#x52A0;&#x5E38;&#x89C1;&#xFF0C;&#x56E0;&#x6B64;&#x5728;&#x9009;&#x62E9; <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mrow><mn>3</mn></mrow></msup></mrow><annotation encoding="application/x-tex">y^{3}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> =&apos;going&apos;&#xFF0C;&#x4E8E;&#x662F;&#x5BF9;&#x4E8E;&#x5408;&#x9002;&#x7684;&#x53E5;&#x6CD5;&#x6765;&#x8BF4;&quot;<strong>Jane is visiting</strong>&quot;&#x76F8;&#x6BD4;&quot;<strong>Jane is going</strong>&quot;&#x4F1A;&#x6709;&#x66F4;&#x9AD8;&#x7684;&#x6982;&#x7387;&#x4F7F;&#x7528;&#xFF0C;&#x6240;&#x4EE5;&#x6709;&#x65F6;&#x5019;&#x771F;&#x6B63;&#x9700;&#x8981;&#x7684;&#x662F;&#x4E00;&#x6B21;&#x6027;&#x6311;&#x9009;&#x6574;&#x4E2A;&#x5355;&#x8BCD;&#x5E8F;&#x5217;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi>y</mi><mrow><mn>1</mn></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mn>2</mn></mrow></msup><mo separator="true">,</mo><msup><mi>y</mi><mrow><mn>3</mn></mrow></msup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msup><mi>y</mi><mrow><mi>t</mi></mrow></msup></mrow><annotation encoding="application/x-tex">y^{1},y^{2},y^{3},...,y^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8141079999999999em;"></span><span class="strut bottom" style="height:1.008548em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mpunct">,</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">t</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span> &#x4F7F;&#x5F97;&#x6574;&#x4F53;&#x7684;&#x6761;&#x4EF6;&#x6982;&#x7387;&#x6700;&#x5927;&#x3002;</p>
<h4 id="4342-&#x96C6;&#x675F;&#x641C;&#x7D22;&#x6D41;&#x7A0B;">4.3.4.2 &#x96C6;&#x675F;&#x641C;&#x7D22;&#x6D41;&#x7A0B;</h4>
<ul>
<li>&#x5B9A;&#x4E49;&#xFF1A;&#x5728;Beam Search&#x4E2D;&#x6709;&#x4E00;&#x4E2A;&#x53C2;&#x6570;B&#xFF0C;&#x53EB;&#x505A;beam width(&#x96C6;&#x675F;&#x5BBD;)&#xFF0C;&#x7528;&#x6765;&#x8868;&#x793A;&#x5728;&#x6BCF;&#x4E00;&#x6B21;&#x7B5B;&#x9009;&#x65F6;&#x6311;top B&#x7684;&#x7ED3;&#x679C;&#x3002;</li>
</ul>
<p>&#x4F8B;&#x5B50;&#x8BF4;&#x660E;&#xFF1A;</p>
<p><img src="../images/%E9%9B%86%E6%9D%9F%E6%90%9C%E7%B4%A2%E6%B5%81%E7%A8%8B.png" alt=""></p>
<ul>
<li>&#x7B2C;&#x4E00;&#x6B21;&#xFF1A;&#x9009;&#x51FA;&#x6982;&#x7387;&#x6700;&#x5927;&#x7684;&#x4E09;&#x4E2A;&#x8BCD;</li>
<li>&#x7B2C;&#x4E8C;&#x6B21;&#xFF1A;&#x9009;&#x62E9;&#x4E0A;&#x4E00;&#x6B65;&#x4E09;&#x4E2A;&#x8BCD;&#xFF0C;&#x6BCF;&#x4E2A;&#x8BCD;&#x5BF9;&#x5E94;&#x4E09;&#x4E2A;&#x6982;&#x7387;&#x6700;&#x5927;&#x7684;&#x8BCD;&#xFF08;&#x53EF;&#x80FD;&#x5B58;&#x5728;&#x91CD;&#x590D;&#xFF09;</li>
<li>....</li>
</ul>
<p>&#x5047;&#x8BBE;&#x53EA;&#x6709;&#x4E24;&#x6B65;&#xFF0C;&#x90A3;&#x4E48;&#x5F97;&#x5230;9&#x4E2A;&#x7ED3;&#x679C;&#x3002;&#x6700;&#x7EC8;&#x6211;&#x4EEC;&#x8981;&#x4ECE;&#x4E2D;&#x9009;&#x51FA;&#x4E09;&#x7EC4;&#x7ED3;&#x679C;</p>
<ul>
<li>is fine</li>
<li>in alright</li>
<li>at alright</li>
</ul>
<p>&#x90A3;&#x4E48;&#x8FD9;&#x4E09;&#x4E2A;&#x53E5;&#x5B50;&#x5C31;&#x662F;&#x6211;&#x4EEC;&#x9700;&#x8981;&#x7684;&#x7ED3;&#x679C;&#x3002;</p>
<h3 id="435-bleu&#x673A;&#x5668;&#x7FFB;&#x8BD1;&#x7684;&#x81EA;&#x52A8;&#x8BC4;&#x4F30;&#x65B9;&#x6CD5;">4.3.5 BLEU-&#x673A;&#x5668;&#x7FFB;&#x8BD1;&#x7684;&#x81EA;&#x52A8;&#x8BC4;&#x4F30;&#x65B9;&#x6CD5;</h3>
<p>&#x5BF9;&#x4E8E;&#x4E0A;&#x8FF0;&#x7B5B;&#x9009;&#x7684;&#x7ED3;&#x679C;&#x6211;&#x4EEC;&#x53EF;&#x4EE5;&#x8BA9;&#x4E00;&#x4E9B;&#x8BED;&#x8A00;&#x4E13;&#x5BB6;&#x8FDB;&#x884C;&#x8BC4;&#x4F30;&#x9009;&#x51FA;&#x6700;&#x5408;&#x9002;&#x7684;&#x3002;&#x5F53;&#x7136;&#x6709;&#x5927;&#x91CF;&#x4EBA;&#x529B;&#x4E5F;&#x662F;&#x53EF;&#x4EE5;&#x8FD9;&#x6837;&#x53BB;&#x505A;&#xFF0C;&#x4F46;&#x662F;&#x6211;&#x4EEC;&#x5E0C;&#x671B;&#x7CFB;&#x7EDF;&#x80FD;&#x591F;&#x81EA;&#x52A8;&#x9009;&#x62E9;&#x4E00;&#x4E2A;&#x6700;&#x5408;&#x9002;&#x7684;&#x7FFB;&#x8BD1;&#x53E5;&#x5B50;&#x3002;&#x9700;&#x8981;&#x63D0;&#x4F9B;&#x4E24;&#x4E2A;</p>
<ul>
<li>1&#x3001;&#x8861;&#x91CF;&#x673A;&#x5668;&#x7FFB;&#x8BD1;&#x7ED3;&#x679C;&#x8D8A;&#x63A5;&#x8FD1;&#x4EBA;&#x5DE5;&#x7FFB;&#x8BD1;&#x7ED3;&#x679C;&#x7684;&#x6570;&#x503C;&#x6307;&#x6807;</li>
<li>2&#x3001;&#x4E00;&#x5957;&#x4EBA;&#x5DE5;&#x7FFB;&#x8BD1;&#x7684;&#x9AD8;&#x8D28;&#x91CF;&#x53C2;&#x8003;&#x8BD1;&#x6587;</li>
</ul>
<h4 id="4351-&#x5B9A;&#x4E49;">4.3.5.1 &#x5B9A;&#x4E49;</h4>
<p>BLEU&#x7684;&#x5168;&#x540D;&#x4E3A;&#xFF1A;bilingual evaluation understudy&#xFF08;&#x53CC;&#x8BED;&#x4E92;&#x8BD1;&#x8D28;&#x91CF;&#x8BC4;&#x4F30;&#x8F85;&#x52A9;&#x5DE5;&#x5177;&#xFF09;&#xFF0C;&#x5B83;&#x662F;&#x7528;&#x6765;&#x8BC4;&#x4F30;&#x673A;&#x5668;&#x7FFB;&#x8BD1;&#x8D28;&#x91CF;&#x7684;&#x5DE5;&#x5177;&#x3002;</p>
<ul>
<li>&#x5224;&#x65AD;&#x4E24;&#x4E2A;&#x53E5;&#x5B50;&#x7684;&#x76F8;&#x4F3C;&#x7A0B;&#x5EA6;</li>
</ul>
<h4 id="4352-ngram-precision&#xFF08;&#x591A;&#x5143;&#x7CBE;&#x5EA6;&#x5F97;&#x5206;&#xFF09;&#x65B9;&#x6CD5;">4.3.5.2 N-gram Precision&#xFF08;&#x591A;&#x5143;&#x7CBE;&#x5EA6;&#x5F97;&#x5206;&#xFF09;&#x65B9;&#x6CD5;</h4>
<ul>
<li>N-gram Precision&#xFF08;&#x591A;&#x5143;&#x7CBE;&#x5EA6;&#x5F97;&#x5206;&#xFF09;</li>
</ul>
<p>&#x8FD9;&#x91CC;&#x7684;N&#x662F;&#x4EC0;&#x4E48;&#x610F;&#x601D;&#xFF0C;&#x6211;&#x4EEC;&#x901A;&#x8FC7;&#x4E00;&#x4E2A;&#x4F8B;&#x5B50;&#x6765;&#x7406;&#x89E3;&#x4E00;&#x4E0B;&#x3002;</p>
<pre><code class="lang-python">&#x5019;&#x9009;&#x7FFB;&#x8BD1;&#xFF1A;    the    the    the    the    the    the    the
&#x53C2;&#x8003;&#x7FFB;&#x8BD1;&#xFF1A;    the    cat    <span class="hljs-keyword">is</span>    on    the    mat    
&#x53C2;&#x8003;&#x7FFB;&#x8BD1;&#xFF1A;    there    <span class="hljs-keyword">is</span>    a    cat    on    the    mat
</code></pre>
<p>&#x4E24;&#x4E2A;&#x53E5;&#x5B50;&#xFF0C;S1&#x548C;S2&#xFF0C;S1&#x91CC;&#x5934;&#x7684;&#x8BCD;&#x51FA;&#x73B0;&#x5728;S2&#x91CC;&#x5934;&#x8D8A;&#x591A;&#xFF0C;&#x5C31;&#x8BF4;&#x660E;&#x8FD9;&#x4E24;&#x4E2A;&#x53E5;&#x5B50;&#x8D8A;&#x4E00;&#x81F4;&#x3002;&#x8BB0;&#x505A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mfrac><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><mn>1</mn></mrow><mrow><mi>n</mi><mi>u</mi><mi>m</mi><mi>b</mi><mi>e</mi><mi>r</mi><mn>2</mn></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{number1}{number2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8801079999999999em;"></span><span class="strut bottom" style="height:1.2251079999999999em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight">m</span><span class="mord mathit mtight">b</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span><span class="mord mathrm mtight">2</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">n</span><span class="mord mathit mtight">u</span><span class="mord mathit mtight">m</span><span class="mord mathit mtight">b</span><span class="mord mathit mtight">e</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span></span></span></span>&#x3002;&#x4E0A;&#x9762;&#x4F8B;&#x5B50;&#xFF0C;&#x5019;&#x9009;&#x7FFB;&#x8BD1;&#x7684;&#x8BCD;7&#x4E2A;&#x8BCD;the&#x90FD;&#x5728;&#x53C2;&#x8003;&#x7FFB;&#x8BD1;&#x4E2D;&#x51FA;&#x73B0;&#xFF0C;&#x8BB0;&#x505A;&#x5206;&#x5B50;&#x5F97;&#x5206;7&#xFF0C;&#x5019;&#x9009;&#x7FFB;&#x8BD1;&#x4E00;&#x5171;&#x5C31;7&#x4E2A;&#x8BCD;&#xFF0C;&#x5206;&#x6BCD;&#x4E3A;7&#x3002;7/7=1&#xFF0C;&#x8BE5;&#x5019;&#x9009;&#x7FFB;&#x8BD1;&#x663E;&#x7136;&#x4E0D;&#x884C;&#xFF01;&#xFF01;&#x8FD9;&#x4E2A;&#x65F6;&#x5019;<strong>N=1&#xFF0C;&#x9009;&#x51FA;&#x4E00;&#x4E2A;&#x8BCD;</strong></p>
<ul>
<li>&#x6539;&#x8FDB;<ul>
<li>&#x539F;&#x56E0;&#xFF1A;&#x5E38;&#x7528;&#x8BCD;&#x5E72;&#x6270;&#x3001;&#x9009;&#x8BCD;&#x7684;&#x7C92;&#x5EA6;&#x592A;&#x5C0F;(the)</li>
<li>&#x4F7F;&#x7528;N-gram,&#x591A;&#x5143;&#x8BCD;&#x7EC4;&#xFF1A;{&#x201C;the cat&#x201D;, &#x201C;cat is&#x201D;, &#x201C;is on&#x201D;, &#x201C;on the&#x201D;, &#x201C;the mat&#x201D;}</li>
</ul>
</li>
</ul>
<h5 id="1&#x3001;&#x540C;&#x6837;&#x8FD8;&#x662F;&#x4E00;&#x4E2A;&#x8BCD;&#x7684;&#x65F6;&#x5019;&#x7684;&#x6539;&#x8FDB;">1&#x3001;&#x540C;&#x6837;&#x8FD8;&#x662F;&#x4E00;&#x4E2A;&#x8BCD;&#x7684;&#x65F6;&#x5019;&#x7684;&#x6539;&#x8FDB;</h5>
<ul>
<li>&#x8FC7;&#x6EE4;&#x5E38;&#x89C1;&#x8BCD;&#xFF08;the on is ...so on&#xFF09;</li>
<li>&#x516C;&#x5F0F;&#x8BA1;&#x7B97;&#xFF08;&#x5206;&#x5B50;&#xFF09;<ul>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msubsup><mi>t</mi><mrow><msub><mi>w</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>j</mi></mrow><mrow><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi></mrow></msubsup><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo>(</mo><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msub><mi>t</mi><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow></msub><mo separator="true">,</mo><mi>R</mi><mi>e</mi><msub><mi>f</mi><mrow><mi>j</mi></mrow></msub><mi mathvariant="normal">_</mi><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msub><mi>t</mi><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow></msub><mo>)</mo></mrow><annotation encoding="application/x-tex">Count_{w_i,j}^{clip} = min(Count_{w_i},Ref_{j}\_Count_{w_i})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9670159999999999em;"></span><span class="strut bottom" style="height:1.379988em;vertical-align:-0.412972em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.276864em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct">,</span><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span><ul>
<li>&#x7EDF;&#x8BA1;&#x5019;&#x9009;&#x533A;&#x57DF;</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msub><mi>t</mi><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">Count_{w_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.68333em;"></span><span class="strut bottom" style="height:0.93343em;vertical-align:-0.2501em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#xFF1A;&#x5019;&#x9009;&#x7FFB;&#x8BD1;&#x4E2D;&#x5355;&#x8BCD;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x51FA;&#x73B0;&#x8FC7;&#x7684;&#x4E2A;&#x6570;&#xFF0C;&#x5982;&#x4E0A;&#x8868;&#x5C31;&#x662F;&#x5BF9;&#x201C;the&#x201D;&#x7684;&#x8BA1;&#x6570;&#x4E3A;7</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mi>e</mi><msub><mi>f</mi><mrow><mi>j</mi></mrow></msub><mi mathvariant="normal">_</mi><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msub><mi>t</mi><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow></msub></mrow><annotation encoding="application/x-tex">Ref_{j}\_Count_{w_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:1.00444em;vertical-align:-0.31em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.15000000000000002em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>:&#x8BCD;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x5728;&#x7B2C;&#x4E2A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>&#x53C2;&#x8003;&#x7FFB;&#x8BD1;&#x91CC;&#x51FA;&#x73B0;&#x7684;&#x6B21;&#x6570;</li>
</ul>
</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mrow><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><mi>t</mi></mrow><mrow><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi></mrow></msup><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msubsup><mi>t</mi><mrow><msub><mi>w</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>j</mi></mrow><mrow><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi></mrow></msubsup><mo>)</mo><mo separator="true">,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mrow><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi></mrow></mrow><annotation encoding="application/x-tex">{Count}^{clip} = max(Count_{w_i,j}^{clip}), i=1,2,{...}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9670159999999999em;"></span><span class="strut bottom" style="height:1.379988em;vertical-align:-0.412972em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord mathit">t</span></span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.276864em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mpunct">,</span><span class="mord mathit">i</span><span class="mrel">=</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">2</span><span class="mpunct">,</span><span class="mord textstyle uncramped"><span class="mord mathrm">.</span><span class="mord mathrm">.</span><span class="mord mathrm">.</span></span></span></span></span><ul>
<li>&#x4F5C;&#x7528;&#xFF1A;&#x9009;&#x51FA;&#x5019;&#x9009;&#x7FFB;&#x8BD1;&#x5728;&#x53C2;&#x8003;&#x7FFB;&#x8BD1;&#x4E2D;&#x6700;&#x5927;&#x7684;&#x8BA1;&#x6570;</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msubsup><mi>t</mi><mrow><msub><mi>w</mi><mi>i</mi></msub><mo separator="true">,</mo><mi>j</mi></mrow><mrow><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">Count_{w_i,j}^{clip}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9670159999999999em;"></span><span class="strut bottom" style="height:1.379988em;vertical-align:-0.412972em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.276864em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathit mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#xFF1A;&#x7B2C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.65952em;"></span><span class="strut bottom" style="height:0.85396em;vertical-align:-0.19444em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05724em;">j</span></span></span></span>&#x4E2A;&#x53C2;&#x8003;&#x7FFB;&#x8BD1;&#xFF0C;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mrow><mi>i</mi></mrow></msub></mrow><annotation encoding="application/x-tex">w_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x8BA1;&#x6570;</li>
<li><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msup><mi>t</mi><mrow><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi></mrow></msup></mrow><annotation encoding="application/x-tex">Count^{clip}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:0.849108em;vertical-align:0em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#xFF1A;&#x5728;&#x6240;&#x6709;&#x53C2;&#x8003;&#x7FFB;&#x8BD1;&#x4E2D;&#x7684;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.43056em;"></span><span class="strut bottom" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight">i</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span>&#x7EFC;&#x5408;&#x8BA1;&#x6570;</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>&#x4ECD;&#x7136;&#x4EE5;&#x4E0A;&#x9762;&#x7684;&#x4F8B;&#x5B50;&#x6765;&#x770B;&#xFF1A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>R</mi><mi>e</mi><msub><mi>f</mi><mrow><mn>1</mn></mrow></msub><mi mathvariant="normal">_</mi><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msub><mi>t</mi><mrow><msup><mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>t</mi><mi>h</mi><msup><mi>e</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup></mrow></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">Ref_{1}\_Count_{&apos;the&apos;}=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.69444em;"></span><span class="strut bottom" style="height:1.00444em;vertical-align:-0.31em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.00773em;">R</span><span class="mord mathit">e</span><span class="mord"><span class="mord mathit" style="margin-right:0.10764em;">f</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.10764em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathrm" style="margin-right:0.02778em;">_</span><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span><span class="mord mathit mtight">h</span><span class="mord mtight"><span class="mord mathit mtight">e</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">2</span></span></span></span>,&#x5219;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msubsup><mi>t</mi><mrow><msup><mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>t</mi><mi>h</mi><msup><mi>e</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo separator="true">,</mo><mn>1</mn></mrow><mrow><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi></mrow></msubsup><mo>=</mo><mi>m</mi><mi>i</mi><mi>n</mi><mo>(</mo><mn>7</mn><mo separator="true">,</mo><mn>2</mn><mo>)</mo><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">Count_{&apos;the&apos;,1}^{clip}=min(7,2)=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9670159999999999em;"></span><span class="strut bottom" style="height:1.404432em;vertical-align:-0.4374159999999999em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.3013079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span><span class="mord mathit mtight">h</span><span class="mord mtight"><span class="mord mathit mtight">e</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">i</span><span class="mord mathit">n</span><span class="mopen">(</span><span class="mord mathrm">7</span><span class="mpunct">,</span><span class="mord mathrm">2</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">2</span></span></span></span>,<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msubsup><mi>t</mi><mrow><msup><mrow></mrow><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mi>t</mi><mi>h</mi><msup><mi>e</mi><mrow><mi mathvariant="normal">&#x2032;</mi></mrow></msup><mo separator="true">,</mo><mn>2</mn></mrow><mrow><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi></mrow></msubsup><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">Count_{&apos;the&apos;,2}^{clip}=1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9670159999999999em;"></span><span class="strut bottom" style="height:1.404432em;vertical-align:-0.4374159999999999em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:0.3013079999999999em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span></span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit mtight">t</span><span class="mord mathit mtight">h</span><span class="mord mtight"><span class="mord mathit mtight">e</span><span class="msupsub"><span class="vlist"><span style="top:-0.286em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">&#x2032;</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathrm mtight">2</span></span></span></span><span style="top:-0.480908em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathrm">1</span></span></span></span>&#xFF0C;&#x6240;&#x4EE5;&#x7EFC;&#x5408;&#x8BA1;&#x6570;&#x4E3A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>C</mi><mi>o</mi><mi>u</mi><mi>n</mi><msup><mi>t</mi><mrow><mi>c</mi><mi>l</mi><mi>i</mi><mi>p</mi></mrow></msup><mo>=</mo><mi>m</mi><mi>a</mi><mi>x</mi><mo>(</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo>)</mo><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">Count^{clip}=max(1,2)=2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.849108em;"></span><span class="strut bottom" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.07153em;">C</span><span class="mord mathit">o</span><span class="mord mathit">u</span><span class="mord mathit">n</span><span class="mord"><span class="mord mathit">t</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight">c</span><span class="mord mathit mtight" style="margin-right:0.01968em;">l</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight">p</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit">m</span><span class="mord mathit">a</span><span class="mord mathit">x</span><span class="mopen">(</span><span class="mord mathrm">1</span><span class="mpunct">,</span><span class="mord mathrm">2</span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathrm">2</span></span></span></span>&#xFF0C;<strong>&#x5206;&#x6BCD;&#x4E0D;&#x53D8;&#xFF0C;&#x4ECD;&#x662F;&#x5019;&#x9009;&#x53E5;&#x5B50;&#x7684;n-gram&#x4E2A;&#x6570;&#x3002;&#x8FD9;&#x91CC;&#x5206;&#x6BCD;&#x4E3A;7&#x3002;</strong>&#x5F97;&#x5206;P = 2/7=0.28</p>
<h5 id="2&#x3001;&#x591A;&#x4E2A;&#x6539;&#x8FDB;&#x7684;&#x591A;&#x5143;&#x7CBE;&#x5EA6;&#xFF08;modified-ngram-precision&#xFF09;&#x8FDB;&#x884C;&#x7EC4;&#x5408;">2&#x3001;&#x591A;&#x4E2A;&#x6539;&#x8FDB;&#x7684;&#x591A;&#x5143;&#x7CBE;&#x5EA6;&#xFF08;modified n-gram precision&#xFF09;&#x8FDB;&#x884C;&#x7EC4;&#x5408;</h5>
<p>n-gram&#x4E0B;&#x7684;&#x53EF;&#x4EE5;&#x8861;&#x91CF;&#x7FFB;&#x8BD1;&#x7684;&#x6D41;&#x7A0B;&#x6027;&#xFF0C;&#x5F53;&#x6211;&#x4EEC;&#x5BF9;&#x4E0D;&#x540C;&#x5C3A;&#x5EA6;&#x7684;&#x8BCD;&#x8FDB;&#x884C;&#x7EDF;&#x8BA1;&#x51FA;&#x6765;&#xFF0C;&#x8BA1;&#x7B97;&#x7CBE;&#x5EA6;&#x7684;&#x65F6;&#x5019;&#xFF0C;&#x7ED3;&#x679C;&#x4E3A;</p>
<p><img src="../images/%E5%A4%9A%E5%85%83%E7%BB%84%E7%B2%BE%E5%BA%A6%E7%BB%9F%E8%AE%A1.png" alt=""></p>
<p>&#x968F;&#x7740;n-gram&#x7684;&#x589E;&#x5927;&#xFF0C;&#x7CBE;&#x5EA6;&#x5F97;&#x5206;&#x603B;&#x4F53;&#x4E0A;&#x6210;&#x6307;&#x6570;&#x4E0B;&#x964D;&#x7684;&#x3002;&#x91C7;&#x53D6;<strong>&#x51E0;&#x4F55;&#x52A0;&#x6743;&#x5E73;&#x5747;</strong>&#xFF0C;&#x5E76;&#x4E14;&#x5C06;&#x5404;n-gram&#x7684;&#x4F5C;&#x7528;&#x89C6;&#x4E3A;&#x7B49;&#x91CD;&#x8981;&#x7684;&#xFF0C;&#x5373;&#x53D6;&#x6743;&#x91CD;&#x670D;&#x4ECE;&#x5747;&#x5300;&#x5206;&#x5E03;&#xFF1A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mrow><mi>a</mi><mi>v</mi><mi>e</mi></mrow></msub><mo>=</mo><mroot><mrow><msubsup><mo>&#x220F;</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></msubsup><msubsup><mi>p</mi><mrow><mi>n</mi></mrow><mrow><msub><mi>w</mi><mrow><mi>n</mi></mrow></msub></mrow></msubsup></mrow><mrow><msubsup><mo>&#x2211;</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>N</mi></mrow></msubsup><msub><mi>w</mi><mrow><mi>n</mi></mrow></msub></mrow></mroot><mo>=</mo><mfrac><mrow><mn>1</mn></mrow><mrow><msubsup><mo>&#x2211;</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>N</mi></mrow></msubsup><msub><mi>w</mi><mrow><mi>n</mi></mrow></msub></mrow></mfrac><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>N</mi></mrow></msubsup><msub><mi>w</mi><mrow><mi>n</mi></mrow></msub><mo>&#x2217;</mo><mi>l</mi><mi>o</mi><msup><mi>g</mi><mrow><msub><mi>p</mi><mrow><mi>n</mi></mrow></msub></mrow></msup><mo>)</mo><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mi>N</mi></mrow></mfrac><mo>&#x2217;</mo><msubsup><mo>&#x2211;</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>N</mi></mrow></msubsup><mi>l</mi><mi>o</mi><msup><mi>g</mi><mrow><msub><mi>p</mi><mrow><mi>n</mi></mrow></msub></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">p_{ave}=\sqrt[\sum_{n=1}^{N}w_{n}]{\prod_{n=1}^Np_{n}^{w_{n}}}=\frac{1}{\sum_{n=1}^{N}w_{n}}exp(\sum_{i=1}^{N}w_{n}*log^{p_{n}})=exp(\frac{1}{N}*\sum_{i=1}^{N}log^{p_{n}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:1.2561705em;"></span><span class="strut bottom" style="height:1.9104425em;vertical-align:-0.654272em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">e</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord sqrt"><span class="root"><span class="vlist"><span style="top:-0.4033926000000001em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptscriptstyle uncramped mtight"><span class="mord scriptscriptstyle uncramped mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="top:0.124995em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.40044em;margin-left:0em;margin-right:0.1em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.404em;margin-right:0.1em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle scriptscriptstyle uncramped mtight"><span class="mord scriptscriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.2em;margin-right:0.1em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="sqrt-sign" style="top:-0.06617050000000013em;"><span class="style-wrap reset-textstyle textstyle uncramped"><span class="delimsizing size2">&#x221A;</span></span></span><span class="vlist"><span style="top:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="mord textstyle cramped"><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x220F;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist"><span style="top:0.11659199999999997em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span></span><span style="top:-0.4448999999999999em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span><span style="top:-1.1761705em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped sqrt-line"></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:1em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mrel">=</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.429565em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mop mtight"><span class="mop op-symbol small-op mtight" style="top:0.074995em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.32101em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.397em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mtight"><span class="mord mathit mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2217;</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mrel">=</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">&#x2217;</span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">i</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>&#x4E0A;&#x9762;&#x56FE;&#x7684;&#x7406;&#x89E3;&#x5C31;&#x4E3A;&#xFF1A;<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mrow><mi>a</mi><mi>v</mi><mi>e</mi></mrow></msub><mo>=</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><mfrac><mrow><mn>1</mn></mrow><mrow><mn>4</mn></mrow></mfrac><mo>&#x2217;</mo><mo>(</mo><mi>l</mi><mi>o</mi><msup><mi>g</mi><mrow><msub><mi>p</mi><mrow><mn>1</mn></mrow></msub></mrow></msup><mo>+</mo><mi>l</mi><mi>o</mi><msup><mi>g</mi><mrow><msub><mi>p</mi><mrow><mn>2</mn></mrow></msub></mrow></msup><mo>+</mo><mi>l</mi><mi>o</mi><msup><mi>g</mi><mrow><msub><mi>p</mi><mrow><mn>3</mn></mrow></msub></mrow></msup><mo>+</mo><mi>l</mi><mi>o</mi><msup><mi>g</mi><mrow><msub><mi>p</mi><mrow><mn>4</mn></mrow></msub></mrow></msup><mo>)</mo><mo>)</mo></mrow><annotation encoding="application/x-tex">p_{ave}=exp(\frac{1}{4}*(log^{p_{1}}+log^{p_{2}}+log^{p_{3}}+log^{p_{4}}))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.845108em;"></span><span class="strut bottom" style="height:1.190108em;vertical-align:-0.345em;"></span><span class="base textstyle uncramped"><span class="mord"><span class="mord mathit">p</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">a</span><span class="mord mathit mtight" style="margin-right:0.03588em;">v</span><span class="mord mathit mtight">e</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mrel">=</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mord reset-textstyle textstyle uncramped"><span class="mopen sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.345em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathrm mtight">4</span></span></span></span><span style="top:-0.22999999999999998em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle textstyle uncramped frac-line"></span></span><span style="top:-0.394em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-textstyle textstyle uncramped nulldelimiter"></span></span><span class="mbin">&#x2217;</span><span class="mopen">(</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">1</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">2</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">3</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">+</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">4</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span><span class="mclose">)</span></span></span></span></p>
<h5 id="3&#x3001;&#x8FDB;&#x884C;&#x77ED;&#x53E5;&#x60E9;&#x7F5A;">3&#x3001;&#x8FDB;&#x884C;&#x77ED;&#x53E5;&#x60E9;&#x7F5A;</h5>
<pre><code>&#x5019;&#x9009;&#x7FFB;&#x8BD1;&#xFF1A;    the    cat                    
&#x53C2;&#x8003;&#x7FFB;&#x8BD1;&#xFF1A;    the    cat    is    on    the    mat    
&#x53C2;&#x8003;&#x7FFB;&#x8BD1;&#xFF1A;    there    is    a    cat    on    the    mat
</code></pre><p>&#x8FD9;&#x6837;&#x5C31;&#x5F88;&#x5BB9;&#x6613;&#x7684;&#x9AD8;&#x5206;&#xFF0C;&#x6240;&#x4EE5;&#x5C31;&#x9700;&#x8981;&#x4E00;&#x4E2A;&#x6709;&#x6548;&#x7684;&#x4E58;&#x60E9;&#x7F5A;&#x673A;&#x5236;&#x3002;&#x6211;&#x4EEC;&#x8BBE;c&#x4E3A;&#x5019;&#x9009;&#x7FFB;&#x8BD1;&#xFF0C;r&#x4E3A;&#x53C2;&#x8003;&#x7FFB;&#x8BD1;&#x3002;&#x5219;&#x6709;&#x4E0B;&#x9762;&#x7684;&#x516C;&#x5F0F;</p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mi>P</mi><mo>=</mo><msubsup><mo>{</mo><mrow><msup><mi>e</mi><mrow><mn>1</mn><mo>&#x2212;</mo><mfrac><mrow><mi>r</mi></mrow><mrow><mi>c</mi></mrow></mfrac></mrow></msup><mo separator="true">,</mo><mi>i</mi><mi>f</mi><mi>c</mi><mo>&#x2264;</mo><mi>r</mi></mrow><mrow><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mi>f</mi><mi>c</mi><mo>&gt;</mo><mi>r</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">BP=\lbrace^{1,ifc&gt;r}_{e^{1-\frac{r}{c}},ifc \leq r}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.9670160000000001em;"></span><span class="strut bottom" style="height:1.6685290000000002em;vertical-align:-0.701513em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mrel">=</span><span class="mopen"><span class="mopen">{</span><span class="msupsub"><span class="vlist"><span style="top:0.565405em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mtight"><span class="mord mathit mtight">e</span><span class="msupsub"><span class="vlist"><span style="top:-0.48775em;margin-right:0.07142857142857144em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathrm mtight">1</span><span class="mbin mtight">&#x2212;</span><span class="mord reset-scriptscriptstyle scriptscriptstyle cramped mtight"><span class="mopen sizing reset-size5 size5 reset-scriptscriptstyle textstyle uncramped nulldelimiter"></span><span class="mfrac"><span class="vlist"><span style="top:0.532em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight">c</span></span></span></span><span style="top:-0.20999999999999996em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle textstyle uncramped frac-line"></span></span><span style="top:-0.387em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptscriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span><span class="mclose sizing reset-size5 size5 reset-scriptscriptstyle textstyle uncramped nulldelimiter"></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">c</span><span class="mrel mtight">&#x2264;</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span style="top:-0.4809080000000002em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathrm mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathit mtight">i</span><span class="mord mathit mtight" style="margin-right:0.10764em;">f</span><span class="mord mathit mtight">c</span><span class="mrel mtight">&gt;</span><span class="mord mathit mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span></p>
<h5 id="4&#x3001;&#x6700;&#x7EC8;bleu&#x503C;&#x5F97;&#x8BA1;&#x7B97;&#x516C;&#x5F0F;">4&#x3001;&#x6700;&#x7EC8;BLEU&#x503C;&#x5F97;&#x8BA1;&#x7B97;&#x516C;&#x5F0F;</h5>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>B</mi><mi>L</mi><mi>E</mi><mi>U</mi><mo>=</mo><mi>B</mi><mi>P</mi><mo>&#x2217;</mo><mi>e</mi><mi>x</mi><mi>p</mi><mo>(</mo><msubsup><mo>&#x2211;</mo><mrow><mi>n</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>N</mi></mrow></msubsup><msub><mi>w</mi><mrow><mi>n</mi></mrow></msub><mo>&#x2217;</mo><mi>l</mi><mi>o</mi><msup><mi>g</mi><mrow><msub><mi>p</mi><mrow><mi>n</mi></mrow></msub></mrow></msup><mo>)</mo></mrow><annotation encoding="application/x-tex">BLEU=BP*exp(\sum_{n=1}^{N}w_{n}*log^{p_{n}})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="strut" style="height:0.8423309999999999em;"></span><span class="strut bottom" style="height:1.142341em;vertical-align:-0.30001em;"></span><span class="base textstyle uncramped"><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit">L</span><span class="mord mathit" style="margin-right:0.05764em;">E</span><span class="mord mathit" style="margin-right:0.10903em;">U</span><span class="mrel">=</span><span class="mord mathit" style="margin-right:0.05017em;">B</span><span class="mord mathit" style="margin-right:0.13889em;">P</span><span class="mbin">&#x2217;</span><span class="mord mathit">e</span><span class="mord mathit">x</span><span class="mord mathit">p</span><span class="mopen">(</span><span class="mop"><span class="mop op-symbol small-op" style="top:-0.0000050000000000050004em;">&#x2211;</span><span class="msupsub"><span class="vlist"><span style="top:0.30001em;margin-left:0em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span><span class="mrel mtight">=</span><span class="mord mathrm mtight">1</span></span></span></span><span style="top:-0.364em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mathit mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mord"><span class="mord mathit" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist"><span style="top:0.15em;margin-right:0.05em;margin-left:-0.02691em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle cramped mtight"><span class="mord scriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mbin">&#x2217;</span><span class="mord mathit" style="margin-right:0.01968em;">l</span><span class="mord mathit">o</span><span class="mord"><span class="mord mathit" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist"><span style="top:-0.363em;margin-right:0.05em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-textstyle scriptstyle uncramped mtight"><span class="mord scriptstyle uncramped mtight"><span class="mord mtight"><span class="mord mathit mtight">p</span><span class="msupsub"><span class="vlist"><span style="top:0.143em;margin-right:0.07142857142857144em;margin-left:0em;"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span><span class="reset-scriptstyle scriptscriptstyle cramped mtight"><span class="mord scriptscriptstyle cramped mtight"><span class="mord mathit mtight">n</span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span></span></span></span><span class="baseline-fix"><span class="fontsize-ensurer reset-size5 size5"><span style="font-size:0em;">&#x200B;</span></span>&#x200B;</span></span></span></span><span class="mclose">)</span></span></span></span></p>
<h3 id="436-&#x603B;&#x7ED3;">4.3.6 &#x603B;&#x7ED3;</h3>
<ul>
<li>&#x638C;&#x63E1;seq2seq&#x6A21;&#x578B;&#x7279;&#x70B9;</li>
<li>&#x638C;&#x63E1;&#x96C6;&#x675F;&#x641C;&#x7D22;&#x65B9;&#x5F0F;</li>
<li>&#x638C;&#x63E1;BLEU&#x8BC4;&#x4F30;&#x65B9;&#x6CD5;</li>
<li>&#x638C;&#x63E1;Attention&#x673A;&#x5236;</li>
</ul>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../day04/section2.html" class="navigation navigation-prev " aria-label="Previous page: 词嵌入与NLP"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../day04/section4.html" class="navigation navigation-next " aria-label="Next page: 总结"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../gitbook/app.js"></script>

    
    <script src="../gitbook/plugins/gitbook-plugin-search/lunr.min.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-search/search.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-sharing/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-fontsettings/buttons.js"></script>
    

    
    <script src="../gitbook/plugins/gitbook-plugin-livereload/plugin.js"></script>
    

<script>
require(["gitbook"], function(gitbook) {
    var config = {"katex":{},"highlight":{},"search":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"livereload":{}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
